{"remainingRequest":"/home/yansha/VDProject/VDFrontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/yansha/VDProject/VDFrontend/src/views/MainView/BottomMainView/TableMainView.vue?vue&type=style&index=0&id=ab6ebe66&scoped=true&lang=scss","dependencies":[{"path":"/home/yansha/VDProject/VDFrontend/src/views/MainView/BottomMainView/TableMainView.vue","mtime":1744442733408},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/css-loader/dist/cjs.js","mtime":1735202380733},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1735202381341},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/@vue/cli-service/node_modules/postcss-loader/src/index.js","mtime":1735202380937},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/sass-loader/dist/cjs.js","mtime":1735202380381},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/cache-loader/dist/cjs.js","mtime":1735202380381},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/vue-loader/lib/index.js","mtime":1735202381045}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ci50YWJsZS1tYWluIHsKICAgIHdpZHRoOiAxMDAlOwogICAgaGVpZ2h0OiAxMDAlOwogICAgYm94LXNpemluZzogYm9yZGVyLWJveDsKfQoKCi5jb250cm9scy1jb250YWluZXIgewogICAgZGlzcGxheTogZmxleDsKICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBnYXA6IDUwcHg7CiAgICAvKiDnu5nmkJzntKLmoYblkozliIbpobXnu4Tku7bmt7vliqDpl7Tot50gKi8KICAgIG1hcmdpbi10b3A6IDIuNXB4Owp9CgoKLnNlYXJjaC1jb250YWluZXIgewogICAgbWFyZ2luLWxlZnQ6IDIwcHg7Cn0KCgouaGVhZGVyLXdyYXBwZXIgewogICAgaGVpZ2h0OiAyMHB4OwogICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgIC8q5by65Yi25Y2V6KGM5pi+56S6Ki8KICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOwogICAgLyrotoXlh7rpg6jliIbnnIHnlaXlj7fooajnpLoqLwogICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgIC8q6LaF5Ye66YOo5YiG6ZqQ6JePKi8KICAgIHBhZGRpbmc6IDVweCAwOwogICAgd2lkdGg6IDEwMCU7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IHJvdzsKICAgIGZsZXgtd3JhcDogbm93cmFwOwogICAgLy9qdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgY29sb3I6ICM1OTU5NTk7Cn0KCi5hY3RpdmUgewogICAgY29sb3I6ICNlNDhlNDE7Cn0K"},{"version":3,"sources":["TableMainView.vue"],"names":[],"mappings":";AAiSA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"TableMainView.vue","sourceRoot":"src/views/MainView/BottomMainView","sourcesContent":["<template>\n\n    <div class=\"table-main\">\n\n        <el-tabs v-model=\"selectedTabValue\" type=\"card\">\n            <el-tab-pane v-for=\"(file, index) in fileList\" :key=\"index\" :label=\"file\" :name=\"file\">\n\n                <el-table v-if=\"tableData\" :data=tableData style=\"width: 100%\" height=\"270\" :stripe=\"true\"\n                    :border=\"true\" size=\"mini\" type=\"index\" :highlight-current-row=\"true\"\n                    @row-click=\"(row, column, event) => handleRowClick(row, file, event)\">\n\n\n                    <el-table-column v-for=\"(value, key) in tableData[0]\" :key=\"key\" :prop=\"key\" :label=\"key\"\n                        height=\"10px\" show-overflow-tooltip fixed>\n\n                        <template #header>\n                            <div class=\"header-wrapper\">\n\n                                <div :title=\"key\" class=\"header-left\"\n                                    style=\"height: 20px; display: inline-flex; align-items: center;\">\n                                    {{ `${key}` }}\n                                </div>\n\n                                <i :class=\"getColumnIcon(key)\" class=\"icon\" @click=\"handleIconClick(key)\"\n                                    style=\"margin-left: 10px; font-size: 14px; vertical-align: middle;\" />\n\n                                <div v-if=\"shouldSortColumn(key)\" class=\"sort-icon-container\"\n                                    style=\"display: flex;flex-direction: column;height: 20px;align-items: center;justify-content: center\">\n                                    <!-- 上升排序箭头 -->\n                                    <i :class=\"{ active: isColumnSorted(key, 'ascending') }\" class=\"el-icon-caret-top\"\n                                        style=\"width: 15px;height: 15px\" @click=\"sortColumn(key, 'ascending')\"></i>\n                                    <!-- 下降排序箭头 -->\n                                    <i :class=\"{ active: isColumnSorted(key, 'descending') }\"\n                                        class=\"el-icon-caret-bottom\" style=\"margin-top: -5px;width: 15px;height: 15px\"\n                                        @click=\"sortColumn(key, 'descending')\"></i>\n                                </div>\n\n                            </div>\n                        </template>\n\n                        <template #default=\"{ row, column }\">\n\n                            <div v-if=\"isShow && column.property === 'Image'\"\n                                style=\"display: flex; justify-content: center; align-items: center;\">\n                                <img :src=\"imagePreUrl + row[column.property]\" alt=\"image\"\n                                    style=\"width: 100px; height: 100px;\" />\n                            </div>\n\n                            <div v-else>\n                                {{ row[column.property] }}\n                            </div>\n                        </template>\n\n                    </el-table-column>\n\n                </el-table>\n\n\n                <div class=\"controls-container\">\n                    <!-- 搜索框 -->\n                    <div class=\"search-container\">\n                        <el-input v-model=\"searchQuery\" placeholder=\"Keyword Search\" @input=\"handleSearch\"\n                            style=\"width: 200px;\" suffix-icon=\"el-icon-search\"></el-input>\n                    </div>\n\n                    <!-- Pagination -->\n                    <el-pagination :current-page=\"currentPage\" :page-size=\"pageSize\" :total=\"totalPage\" small background\n                        class=\"pagination-class\" layout=\"total, prev, pager, next\" @current-change=\"handlePageChange\" />\n                </div>\n\n\n            </el-tab-pane>\n        </el-tabs>\n\n    </div>\n\n</template>\n\n<script>\n\nimport * as d3 from \"d3\";\nimport { mapState } from \"vuex\";\nimport api from \"@/api/data\";\nimport { onUpdated } from \"vue\";\nimport { debounce } from 'lodash';\n\nexport default {\n    name: \"TableMainView\",\n    components: {\n\n    },\n    data() {\n        return {\n            selectedTabValue: \"None\",\n            fileList: [],\n            fileContent: {},\n\n            currentPage: 1,\n            pageData: [],\n            pageSize: 10, // Number of items per page\n            totalPage: 0,\n            sortedData: [],\n\n            imagePreUrl: \"\",\n            isShow: false,\n\n            searchQuery: \"\",\n            filterdData: [],\n            sortOrder: \"\",\n            sortCol: \"\"\n\n        };\n    },\n    mounted() {\n\n    },\n    methods: {\n\n        async getTableInfo(data) {\n            const response = await api.getTableContent({ \"datasetName\": data });\n            this.fileList = response[\"data\"][\"tableList\"]\n            this.selectedTabValue = this.fileList[0]\n        },\n        async getPageData() {\n            const response = await api.getPageData({\n                \"datasetName\": this.$store.state.datasetName,\n                \"fileName\": this.selectedTabValue,\n                \"currentPage\": this.currentPage\n            });\n\n            this.pageData = response[\"data\"][\"pageData\"];\n            this.totalPage = response[\"data\"][\"totalPage\"];\n             \n\n            if(this.$store.state.datasetName == \"Wit\"){\n                this.imagePreUrl = response[\"data\"][\"preBaseUrl\"] + \"vision/\";\n            }else{\n                this.imagePreUrl = response[\"data\"][\"preBaseUrl\"];\n            }\n\n            console.log(\"URL\", this.imagePreUrl)\n            this.$store.commit(\"setTableData\", this.pageData)\n\n        },\n        handleSearch: debounce(async function(e) {\n            // 如果事件被正确触发，发送请求：\n            const response = await api.getFiterData({\n                \"datasetName\": this.$store.state.datasetName,\n                \"fileName\": this.selectedTabValue,\n                \"currentPage\": this.currentPage,\n                \"queryText\": this.searchQuery\n            });\n\n            this.filterdData = response[\"data\"][\"filterdData\"];\n            this.$store.commit(\"setTableData\", this.filterdData);\n            this.totalPage = response[\"data\"][\"totalPage\"];\n\n            console.log(\"filter results id\", response[\"data\"][\"idList\"])\n\n            if(response[\"data\"][\"idList\"].length > 0){\n\n                console.log(\"filter results id\", response[\"data\"][\"idList\"])\n                this.$store.commit(\"setTableFiterResults\", response[\"data\"][\"idList\"]);\n\n                console.log(this.$store.state.tableFiterResults)\n            }\n\n            if (this.$store.state.datasetName == \"Wit\") {\n                this.imagePreUrl = response[\"data\"][\"preBaseUrl\"] + \"vision/\";\n            } else {\n                this.imagePreUrl = response[\"data\"][\"preBaseUrl\"];\n            }\n\n        }, 800),  // 300 毫秒的延迟\n        handlePageChange(page) {\n            this.currentPage = page;\n        },\n        getColumnIcon(col) {\n\n            if (col === \"Image\") {\n                return \"el-icon-view\";\n            }\n\n        },\n        shouldSortColumn(col) {\n\n            if (col === \"distance\") {\n                return true;\n            } else if (col == \"Id\" || col == \"id\") {\n                return true;\n            }\n        },\n        isColumnSorted(col, order) {\n            return this.sortCol === col && this.sortOrder === order;\n        },\n        async sortColumn(col, order) {\n\n            // 如果事件被正确触发，发送请求：\n            const response = await api.getSortData({\n                \"datasetName\": this.$store.state.datasetName,\n                \"fileName\": this.selectedTabValue,\n                \"currentPage\": this.currentPage,\n                \"field\": col,\n                \"sortOrder\": order\n            });\n\n            this.sortedData = response[\"data\"][\"sortedData\"];\n            this.$store.commit(\"setTableData\", this.sortedData);\n            this.totalPage = response[\"data\"][\"totalPage\"];\n\n            if(this.$store.state.datasetName == \"Wit\"){\n                this.imagePreUrl = response[\"data\"][\"preBaseUrl\"] + \"vision/\";\n            }else{\n                this.imagePreUrl = response[\"data\"][\"preBaseUrl\"];\n            }\n\n            this.sortCol = col;\n            this.sortOrder = order;\n\n        },\n        handleIconClick(col) {\n            if (col === \"Image\") {\n                this.isShow = !this.isShow;\n            }\n\n        },\n        handleRowClick(row, file, e) {\n            // 从点击的行中获取到对应数据的 id\n            const dataId = (row[\"Id\"] !== undefined ? row[\"Id\"] : row[\"id\"]);\n            console.log(\"选中的id到底是什么！！！！\", row, dataId)\n            console.log(\"ndoelindjgsYFGcyuqegfyu\", this.$store.state.selectedNode)\n            // 提交给全局我当前选中的node id 从而使得各个视图之间的联动\n            this.$store.commit(\"setSelectedNode\", dataId);\n            console.log(\"ndoelindjgsYFGcyuqegfyu\", this.$store.state.selectedNode, \"hahahhaaaaaaaaaaaaaaaaaaaaaaaaaaa\")\n        }\n\n    },\n    computed: {\n        ...mapState({\n            datasetName: \"datasetName\",\n            tableData: \"tableData\",\n            updateTable: \"updateTable\"\n\n        })\n\n    },\n    watch: {\n        datasetName(newVal, oldVal) {\n\n            if (newVal !== oldVal) {\n                this.getTableInfo(newVal);\n                this.selectedTabValue = \"\";\n            }\n\n        },\n        currentPage(newVal, oldVal) {\n            if (this.searchQuery == \"\") {\n                if (this.$store.state.datasetName !== \"\" && this.selectedTabValue != \"\") {\n                    if (this.selectedTabValue) {\n                        this.getPageData();\n                    }\n                }\n            } else {\n                this.handleSearch();\n            }\n        },\n        selectedTabValue(newVal, oldVal) {\n            if (this.$store.state.datasetName !== \"\") {\n                if (this.selectedTabValue) {\n                    this.currentPage = 1;\n                    this.getPageData();\n                }\n\n            }\n\n        },\n        updateTable(newVal, oldVal) {\n            if (newVal === true) {\n                this.getTableInfo(this.$store.state.datasetName);\n                this.getPageData();\n            }\n\n        }\n    }\n};\n</script>\n\n\n<style scoped lang=\"scss\">\n.table-main {\n    width: 100%;\n    height: 100%;\n    box-sizing: border-box;\n}\n\n\n.controls-container {\n    display: flex;\n    justify-content: flex-start;\n    align-items: center;\n    gap: 50px;\n    /* 给搜索框和分页组件添加间距 */\n    margin-top: 2.5px;\n}\n\n\n.search-container {\n    margin-left: 20px;\n}\n\n\n.header-wrapper {\n    height: 20px;\n    white-space: nowrap;\n    /*强制单行显示*/\n    text-overflow: ellipsis;\n    /*超出部分省略号表示*/\n    overflow: hidden;\n    /*超出部分隐藏*/\n    padding: 5px 0;\n    width: 100%;\n    display: flex;\n    flex-direction: row;\n    flex-wrap: nowrap;\n    //justify-content: center;\n    align-items: center;\n    box-sizing: border-box;\n    color: #595959;\n}\n\n.active {\n    color: #e48e41;\n}\n</style>\n\n<style>\n.el-tabs--card>.el-tabs__header {\n    padding: 0;\n    position: relative;\n    margin: 0 0 0px;\n    background-color: white;\n}\n\n.el-tabs__content {\n    overflow: hidden;\n    position: relative;\n    margin-left: 1.5px;\n    background-color: white;\n}\n</style>"]}]}