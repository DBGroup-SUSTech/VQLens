{"remainingRequest":"/home/yansha/VDProject/VDFrontend/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/yansha/VDProject/VDFrontend/src/views/MainView/MiddleMainView/NodeLinkView.vue?vue&type=script&lang=js","dependencies":[{"path":"/home/yansha/VDProject/VDFrontend/src/views/MainView/MiddleMainView/NodeLinkView.vue","mtime":1734619211212},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/cache-loader/dist/cjs.js","mtime":1735202380381},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/babel-loader/lib/index.js","mtime":1735202380921},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/cache-loader/dist/cjs.js","mtime":1735202380381},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/vue-loader/lib/index.js","mtime":1735202381045}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCAqIGFzIGQzIGZyb20gImQzIjsKaW1wb3J0IHsgbWFwU3RhdGUgfSBmcm9tICJ2dWV4IjsKaW1wb3J0IGFwaSBmcm9tICJAL2FwaS9kYXRhIjsKCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiTm9kZUxpbmtWaWV3IiwKICBjb21wb25lbnRzOiB7fSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgbm9kZWxpbmtkYXRhOiB7fSwKICAgICAgc3ZnV2lkdGg6IDAsICAvLyDpobXpnaLnmoTlrr3luqYKICAgICAgc3ZnSGVpZ2h0OiAwLCAgIC8vIOmhtemdoumrmOW6pgogICAgICB2ZWxvY2l0eURlY2F5OiAwLjYsCiAgICAgIHRodW1ibmFpbFdpZHRoOiAwLCAvLyDnvKnnlaXlm77lrr3luqYKICAgICAgdGh1bWJuYWlsSGVpZ2h0OiAwLCAvLyDnvKnnlaXlm77pq5jluqYKICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRWaWV3U2l6ZSgpOwogICAgdGhpcy5ub2RlbGlua2RhdGEgPSB0aGlzLiRzdG9yZS5zdGF0ZS5kYXRhTm9kZUxpbms7CiAgICBjb25zb2xlLmxvZygi6K+36L6T5Ye6IGxpbmsgZGF0YSDmnaXnnIvkuIDkuIvov57mjqXnur/nmoQgZGF0YSIsdGhpcy5ub2RlbGlua2RhdGEpOwogICAgdGhpcy5pbml0R3JhcGgodGhpcy5ub2RlbGlua2RhdGEpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0Vmlld1NpemUoKSB7CiAgICAgIGNvbnN0IGRhZyA9IHRoaXMuJHJlZnMuZGFnOwogICAgICB0aGlzLnN2Z0hlaWdodCA9IGRhZy5jbGllbnRIZWlnaHQ7CiAgICAgIHRoaXMuc3ZnV2lkdGggPSBkYWcuY2xpZW50V2lkdGg7CiAgICAgIHRoaXMudGh1bWJuYWlsV2lkdGggPSB0aGlzLnN2Z1dpZHRoIC8gNTsgIC8vIOe8qeeVpeWbvuWuveW6puWSjOmrmOW6puWIhuWIq+S4uuaVtOS4qnN2ZyDnmoQxLzUKICAgICAgdGhpcy50aHVtYm5haWxIZWlnaHQgPSB0aGlzLnN2Z0hlaWdodCAvIDU7CiAgICAgIGlmICh0aGlzLm5vZGVsaW5rZGF0YS5ub2RlcykgewogICAgICAgIHRoaXMuaW5pdEdyYXBoKHRoaXMubm9kZWxpbmtkYXRhKTsKICAgICAgICB0aGlzLmluaXRUaHVtYm5haWwoKTsKICAgICAgfQogICAgfSwKICAgIGFzeW5jIGNvbnZlcnRUb0ltYWdlKGV2ZW50LCBub2RlKSB7CiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFwaS5nZXRJbWFnZVVybCh7ICJkYXRhc2V0TmFtZSI6IHRoaXMuJHN0b3JlLnN0YXRlLmRhdGFzZXROYW1lLCAibm9kZUlkIjogbm9kZS5pZCB9KTsKICAgICAgY29uc3QgaW1hZ2VVcmwgPSByZXNbImRhdGEiXVsiaW1hZ2VVcmwiXTsKICAgICAgY29uc3QgdGFyZ2V0RWxlbWVudCA9IGQzLnNlbGVjdChldmVudC50YXJnZXQpOwogICAgICBjb25zdCB0YXJnZXRCQm94ID0gdGFyZ2V0RWxlbWVudC5ub2RlKCkuZ2V0QkJveCgpOwogICAgICBjb25zdCB0YXJnZXRXaWR0aCA9IHRhcmdldEJCb3gud2lkdGg7CiAgICAgIGNvbnN0IHRhcmdldEhlaWdodCA9IHRhcmdldEJCb3guaGVpZ2h0OwogICAgICBjb25zdCBwYXR0ZXJuSWQgPSBgcGF0dGVybi0ke25vZGUuaWR9YDsKICAgICAgbGV0IHBhdHRlcm4gPSBkMy5zZWxlY3QoYCMke3BhdHRlcm5JZH1gKTsKICAgICAgaWYgKHBhdHRlcm4uZW1wdHkoKSkgewogICAgICAgIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdChgI25vZGUtY2xhc3NgKTsKICAgICAgICBsZXQgZGVmcyA9IHN2Zy5zZWxlY3QoImRlZnMiKS5hdHRyKCJ3aWR0aCIsIHRhcmdldFdpZHRoKS5hdHRyKCJoZWlnaHQiLCB0YXJnZXRIZWlnaHQpOwogICAgICAgIGlmIChkZWZzLmVtcHR5KCkpIHsKICAgICAgICAgIGRlZnMgPSBzdmcuYXBwZW5kKCJkZWZzIikuYXR0cigid2lkdGgiLCB0YXJnZXRXaWR0aCkuYXR0cigiaGVpZ2h0IiwgdGFyZ2V0SGVpZ2h0KTsKICAgICAgICB9CiAgICAgICAgY29uc3QgcGF0dGVybiA9IGRlZnMuYXBwZW5kKCJwYXR0ZXJuIikKICAgICAgICAgIC5hdHRyKCJpZCIsIHBhdHRlcm5JZCkKICAgICAgICAgIC5hdHRyKCJwYXR0ZXJuVW5pdHMiLCAib2JqZWN0Qm91bmRpbmdCb3giKQogICAgICAgICAgLmF0dHIoIndpZHRoIiwgMSkgLy8g5a695bqm5Li6IDEg6KGo56S655u45a+55LqO55uu5qCH5YWD57Sg55qE5a695bqmCiAgICAgICAgICAuYXR0cigiaGVpZ2h0IiwgMSkgLy8g6auY5bqm5Li6IDEg6KGo56S655u45a+55LqO55uu5qCH5YWD57Sg55qE6auY5bqmCiAgICAgICAgICAuYXR0cigicGF0dGVyblRyYW5zZm9ybSIsICJ0cmFuc2xhdGUoMSwgMSkiKTsgLy8g5ZCR5Y+z5ZKM5ZCR5LiL56e75YqoIDEwIOS4quWNleS9jQoKICAgICAgICBjb25zdCBpbWFnZSA9IHBhdHRlcm4uYXBwZW5kKCJpbWFnZSIpCiAgICAgICAgICAuYXR0cigieGxpbms6aHJlZiIsIGltYWdlVXJsKQogICAgICAgICAgLmF0dHIoIndpZHRoIiwgNTgpCiAgICAgICAgICAuYXR0cigiaGVpZ2h0IiwgNTgpCiAgICAgICAgICAuYXR0cigicHJlc2VydmVBc3BlY3RSYXRpbyIsICJ4TWlkWU1pZCBzbGljZSIpOwogICAgICB9CiAgICAgIHRhcmdldEVsZW1lbnQKICAgICAgICAuYXR0cigiciIsIDMwKQogICAgICAgIC5hdHRyKCJmaWxsIiwgYHVybCgjcGF0dGVybi0ke25vZGUuaWR9KWApCiAgICAgICAgLmF0dHIoInN0cm9rZSIsICIjMDAwIikgLy8g6K6+572u6L655qGG6aKc6ImyCiAgICAgICAgLmF0dHIoInN0cm9rZS13aWR0aCIsIDIpOyAvLyDorr7nva7ovrnmoYblrr3luqY7CgogICAgfSwKICAgIGluaXRUaHVtYm5haWwoKSB7CiAgICAgIGNvbnN0IHRodW1ibmFpbCA9IGQzLnNlbGVjdCh0aGlzLiRyZWZzLnRodW1ibmFpbCk7CiAgICAgIHRodW1ibmFpbAogICAgICAgIC5hdHRyKCJ3aWR0aCIsIHRoaXMudGh1bWJuYWlsV2lkdGgpCiAgICAgICAgLmF0dHIoImhlaWdodCIsIHRoaXMudGh1bWJuYWlsSGVpZ2h0KQogICAgICAgIC5hdHRyKCJ2aWV3Qm94IiwgYDAgMCAke3RoaXMuc3ZnV2lkdGh9ICR7dGhpcy5zdmdIZWlnaHR9YCkKICAgICAgICAuYXR0cigicHJlc2VydmVBc3BlY3RSYXRpbyIsICJ4TWlkWU1pZCBtZWV0IikKICAgICAgICAuYXR0cigic3R5bGUiLCAicG9zaXRpb246IGFic29sdXRlOyBib3R0b206IDIwcHg7IGxlZnQ6IDIwcHg7IGJvcmRlcjogMXB4IHNvbGlkICNjY2M7IGJhY2tncm91bmQ6ICNmZmY7Iik7CiAgICB9LAogICAgdXBkYXRlVGh1bWJuYWlsKCkgewogICAgICBjb25zdCB0aGF0ID0gdGhpczsKICAgICAgY29uc3QgdGh1bWJuYWlsID0gZDMuc2VsZWN0KHRoYXQuJHJlZnMudGh1bWJuYWlsKTsKICAgICAgdGh1bWJuYWlsLnNlbGVjdEFsbCgiKiIpLnJlbW92ZSgpOwogICAgICBjb25zdCBjb250YWluZXIgPSB0aHVtYm5haWwuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgYHNjYWxlKCR7dGhhdC50aHVtYm5haWxXaWR0aCAvIHRoYXQuc3ZnV2lkdGh9LCAke3RoYXQudGh1bWJuYWlsSGVpZ2h0IC8gdGhhdC5zdmdIZWlnaHR9KWApOwoKICAgICAgLy8gQ2xvbmUgbGVnZW5kIGFuZCBsaW5rIG5vZGVzCiAgICAgIGNvbnN0IGxlZ2VuZE5vZGUgPSBkMy5zZWxlY3QodGhhdC4kcmVmcy5kYWcpLnNlbGVjdCgiZy5ub2RlcyIpLm5vZGUoKS5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgIGNvbnN0IGxpbmtOb2RlID0gZDMuc2VsZWN0KHRoYXQuJHJlZnMuZGFnKS5zZWxlY3QoImcubGluayIpLm5vZGUoKS5jbG9uZU5vZGUodHJ1ZSk7CiAgICAgIGNvbnRhaW5lci5hcHBlbmQoKCkgPT4gbGVnZW5kTm9kZSk7CiAgICAgIGNvbnRhaW5lci5hcHBlbmQoKCkgPT4gbGlua05vZGUpOwoKICAgIH0sCgogICAgaW5pdEdyYXBoKGRhdGEpIHsKICAgICAgY29uc3QgdGhhdCA9IHRoaXM7CiAgICAgIGNvbnN0IHdpZHRoID0gdGhhdC5zdmdXaWR0aDsKICAgICAgY29uc3QgaGVpZ2h0ID0gdGhhdC5zdmdIZWlnaHQ7CiAgICAgIGNvbnN0IHJlY2FsbCA9IGRhdGFbIm1ldHJpYyJdWydyZWNhbGwnXTsKICAgICAgY29uc3QgbGlua3MgPSBkYXRhLmxpbmtzLm1hcChkID0+ICh7IC4uLmQgfSkpOwogICAgICBjb25zdCBub2RlcyA9IGRhdGEubm9kZXMubWFwKGQgPT4gKHsgLi4uZCB9KSk7CgogICAgICAvLyDlnKjov5nph4zojrflj5YgbGlua3MgdmFsdWUg5Lit55qE5pyA5aSn5YC85ZKM5pyA5bCP5YC8CiAgICAgIGNvbnN0IHZhbCA9IGxpbmtzLm1hcChkID0+IGQudmFsdWUpOwogICAgICBjb25zdCBtaW5WYWwgPSBNYXRoLm1pbiguLi52YWwpOwogICAgICBjb25zdCBtYXhWYWwgPSBNYXRoLm1heCguLi52YWwpOwoKICAgICAgLy8g5a6a5LmJ5b2S5LiA5YyW5Ye95pWwCiAgICAgIC8vIOWumuS5ieW9kuS4gOWMluWHveaVsO+8jOehruS/neacgOWwj+WAvOS4jeS4uiAwCiAgICAgIGNvbnN0IG5vcm1hbGl6ZSA9ICh2YWx1ZSkgPT4gewogICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRWYWx1ZSA9ICh2YWx1ZSAtIG1pblZhbCkgLyAobWF4VmFsIC0gbWluVmFsKTsKICAgICAgICAvLyDlsIblvZLkuIDljJblgLzojIPlm7TosIPmlbTkuLogW2EsIDFd77yM5YW25LitIGEg5Li655Wl5aSn5LqOIDAg55qE5pWw5YC877yM5L6L5aaCIDAuMQogICAgICAgIGNvbnN0IGEgPSAwLjE7CiAgICAgICAgcmV0dXJuIDEwKihub3JtYWxpemVkVmFsdWUgKiAoMSAtIGEpICsgYSk7CiAgICAgIH07CgogICAgICBjb25zdCBzaW11bGF0aW9uID0gZDMuZm9yY2VTaW11bGF0aW9uKG5vZGVzKQogICAgICAgIC5mb3JjZSgibGluayIsIGQzLmZvcmNlTGluayhsaW5rcykuaWQoZCA9PiBkLmlkKSkKICAgICAgICAvLyAuZGlzdGFuY2UoZCA9PiBub3JtYWxpemUoZC52YWx1ZSkvMTAwMDAwKSkKICAgICAgICAuZm9yY2UoImNoYXJnZSIsIGQzLmZvcmNlTWFueUJvZHkoKS5zdHJlbmd0aCgtMTApKQogICAgICAgIC5mb3JjZSgiY2VudGVyIiwgZDMuZm9yY2VDZW50ZXIod2lkdGggLyAyLCBoZWlnaHQgLyAyKS5zdHJlbmd0aCgwLjMpKQogICAgICAgIC8vIC5mb3JjZSgicmFkaWFsIiwgZDMuZm9yY2VSYWRpYWwoNTAwLCB3aWR0aCAvIDIsIGhlaWdodCAvIDIpLnN0cmVuZ3RoKDAuOCkpCiAgICAgICAgLy8gLmZvcmNlKCJ4IiwgZDMuZm9yY2VYKHdpZHRoIC8gMikuc3RyZW5ndGgoMC4wNSkpCiAgICAgICAgLy8gLmZvcmNlKCJ5IiwgZDMuZm9yY2VZKGhlaWdodCAvIDIpLnN0cmVuZ3RoKDAuMDUpKQogICAgICAgIC52ZWxvY2l0eURlY2F5KHRoaXMudmVsb2NpdHlEZWNheSkKICAgICAgICAub24oInRpY2siLCB0aWNrZWQpOwoKICAgICAgY29uc3Qgc3ZnID0gZDMuc2VsZWN0KHRoaXMuJHJlZnMuZGFnKTsKICAgICAgc3ZnLnNlbGVjdEFsbCgiKiIpLnJlbW92ZSgpOwoKICAgICAgc3ZnLmF0dHIoInZpZXdCb3giLCBgMCAwICR7d2lkdGh9ICR7aGVpZ2h0fWApCiAgICAgICAgLmF0dHIoIndpZHRoIiwgIjEwMCUiKQogICAgICAgIC5hdHRyKCJoZWlnaHQiLCAiMTAwJSIpCiAgICAgICAgLmF0dHIoInByZXNlcnZlQXNwZWN0UmF0aW8iLCAieE1pZFlNaWQgbWVldCIpCiAgICAgICAgLmF0dHIoInN0eWxlIiwgIm1heC13aWR0aDogMTAwJTsgaGVpZ2h0OiBhdXRvOyIpCiAgICAgICAgLmNhbGwoZDMuem9vbSgpLnNjYWxlRXh0ZW50KFswLjUsIDhdKS5vbigiem9vbSIsIHpvb21lZCkpOwoKICAgICAgY29uc3QgY29sb3JNYXAgPSBkMy5zY2FsZU9yZGluYWwoKQogICAgICAgIC5yYW5nZShbJyNGRjAwMDAnLCAnI0E0RDNFRScsICcjRkY3RjUwJywgJyMzMkNEMzInXSk7CiAgICAgICAgY29uc3QgZ3JvdXBDb2xvck1hcCA9IHsKICAgICAgICAgIDA6ICIjRkYwMDAwIiwKICAgICAgICAgIDE6ICIjQTREM0VFIiwKICAgICAgICAgIDI6ICIjMzJDRDMyIiwKICAgICAgICAgIDM6ICIjRkY3RjUwIiwKICAgICAgICB9OwoKICAgICAgY29uc3QgY29udGFpbmVyID0gc3ZnLmFwcGVuZCgiZyIpOwogICAgICBjb25zdCBsaW5rID0gY29udGFpbmVyLmFwcGVuZCgiZyIpCiAgICAgICAgLmF0dHIoImNsYXNzIiwgImxpbmsiKQogICAgICAgIC5hdHRyKCJzdHJva2UiLCAiIzk5OSIpCiAgICAgICAgLmF0dHIoInN0cm9rZS1vcGFjaXR5IiwgMC42KQogICAgICAgIC5zZWxlY3RBbGwoImxpbmUiKQogICAgICAgIC5kYXRhKGxpbmtzKQogICAgICAgIC5qb2luKCJsaW5lIikKICAgICAgICAuYXR0cigic3Ryb2tlLXdpZHRoIiwgZCA9PiBNYXRoLnNxcnQobm9ybWFsaXplKGQudmFsdWUpKSkKICAgICAgICAuYXR0cigibWFya2VyLWVuZCIsICJ1cmwoI2Fycm93aGVhZCkiKQogICAgICAgIC5hdHRyKCJmaWxsIiwgZCA9PiBncm91cENvbG9yTWFwW2QuZ3JvdXBdKTsKCiAgICAgIGNvbnN0IGJvcmRlciA9IGNvbnRhaW5lci5hcHBlbmQoImciKQogICAgICAgIC5zZWxlY3RBbGwoImNpcmNsZSIpCiAgICAgICAgLmRhdGEobm9kZXMpCiAgICAgICAgLmpvaW4oImNpcmNsZSIpCiAgICAgICAgLmF0dHIoInIiLCB2ID0+IHsKICAgICAgICAgIGlmICh2Lmdyb3VwID09PSAwKSB7CiAgICAgICAgICAgIHJldHVybiAyMDsKICAgICAgICAgIH0gZWxzZSBpZiAodi5ncm91cCA9PT0gMykgewogICAgICAgICAgICByZXR1cm4gMTU7CiAgICAgICAgICB9IGVsc2UgaWYgKHYuZ3JvdXAgPT09IDIpIHsKICAgICAgICAgICAgcmV0dXJuIDE1OwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmV0dXJuIDEyLjU7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuYXR0cigiZmlsbCIsICJub25lIikKICAgICAgICAuYXR0cigic3Ryb2tlIiwgIm5vbmUiKQogICAgICAgIC5hdHRyKCJzdHJva2Utd2lkdGgiLCAyKTsKCiAgICAgIGNvbnN0IG5vZGUgPSBjb250YWluZXIuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigiY2xhc3MiLCAibm9kZXMiKQogICAgICAgIC5hdHRyKCJpZCIsIGBub2RlLWNsYXNzYCkKICAgICAgICAuYXR0cigic3Ryb2tlIiwgIiNmZmYiKQogICAgICAgIC5hdHRyKCJzdHJva2Utd2lkdGgiLCAwLjIpCiAgICAgICAgLnNlbGVjdEFsbCgiY2lyY2xlIikKICAgICAgICAuZGF0YShub2RlcykKICAgICAgICAuam9pbigiY2lyY2xlIikKICAgICAgICAuYXR0cigiciIsIHYgPT4gewogICAgICAgICAgaWYgKHYuZ3JvdXAgPT09IDApIHsKICAgICAgICAgICAgcmV0dXJuIDE4OwogICAgICAgICAgfSBlbHNlIGlmICh2Lmdyb3VwID09PSAzKSB7CiAgICAgICAgICAgIHJldHVybiAxMzsKICAgICAgICAgIH0gZWxzZSBpZiAodi5ncm91cCA9PT0gMikgewogICAgICAgICAgICByZXR1cm4gMTM7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gMTAuNTsKICAgICAgICAgIH0KICAgICAgICB9KQogICAgICAgIC5hdHRyKCJmaWxsIiwgZCA9PiBncm91cENvbG9yTWFwW2QuZ3JvdXBdKQogICAgICAgIC5jYWxsKGQzLmRyYWcoKQogICAgICAgICAgLm9uKCJzdGFydCIsIGRyYWdzdGFydGVkKQogICAgICAgICAgLm9uKCJkcmFnIiwgZHJhZ2dlZCkKICAgICAgICAgIC5vbigiZW5kIiwgZHJhZ2VuZGVkKSk7CgogICAgICBjb25zdCBsYWJlbHMgPSBjb250YWluZXIuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigiY2xhc3MiLCAibGFiZWxzIikKICAgICAgICAuc2VsZWN0QWxsKCJ0ZXh0IikKICAgICAgICAuZGF0YShub2RlcykKICAgICAgICAuam9pbigidGV4dCIpCiAgICAgICAgLmF0dHIoImR4IiwgNikKICAgICAgICAuYXR0cigiZHkiLCAiLjM1ZW0iKQogICAgICAgIC5zdHlsZSgiZm9udC1zaXplIiwgIjEycHgiKSAgLy8g6K6+572u5a2X5L2T5aSn5bCPCiAgICAgICAgLmF0dHIoInN0cm9rZSIsICJ3aGl0ZSIpCiAgICAgICAgLmF0dHIoInBhaW50LW9yZGVyIiwgInN0cm9rZSIpCiAgICAgICAgLnRleHQoZCA9PiB7CiAgICAgICAgICBpZiAoZC5ncm91cCA9PT0gMiB8fCBkLmdyb3VwID09PSAzKSB7CiAgICAgICAgICAgIHJldHVybiBgJHtkLmlkfWA7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgICB9CiAgICAgICAgfSk7CgogICAgICBub2RlLm9uKCJtb3VzZW92ZXIiLCBmdW5jdGlvbiAoZXZlbnQsIGQpIHsKICAgICAgICBib3JkZXIuYXR0cigic3Ryb2tlIiwgKGIpID0+IGIuaWQgPT09IGQuaWQgPyAiIzYwOTZFNiIgOiAibm9uZSIpOwogICAgICB9KQogICAgICAgIC5vbigibW91c2VvdXQiLCBmdW5jdGlvbiAoZXZlbnQsIGQpIHsKICAgICAgICAgIGJvcmRlci5hdHRyKCJzdHJva2UiLCAibm9uZSIpOwogICAgICAgIH0pOwoKICAgICAgbm9kZS5vbigiY2xpY2siLCBmdW5jdGlvbiAoZXZlbnQsIGQpIHsKICAgICAgICBjb25zdCBleGlzdGluZ0JveCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5vcHRpb24tYm94Jyk7CiAgICAgICAgaWYgKGV4aXN0aW5nQm94KSB7CiAgICAgICAgICBpZiAocGFyc2VJbnQoZXhpc3RpbmdCb3guZGF0YXNldC5ub2RlSWQpID09PSBwYXJzZUludChkLmlkKSkgewogICAgICAgICAgICBleGlzdGluZ0JveC5yZW1vdmUoKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQogICAgICAgICAgZXhpc3RpbmdCb3gucmVtb3ZlKCk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IG9wdGlvbnMgPSBkMy5zZWxlY3QoImJvZHkiKS5hcHBlbmQoImRpdiIpCiAgICAgICAgICAuYXR0cigiY2xhc3MiLCAib3B0aW9uLWJveCIpCiAgICAgICAgICAuYXR0cigiZGF0YS1ub2RlLWlkIiwgZC5pZCkKICAgICAgICAgIC5zdHlsZSgicG9zaXRpb24iLCAiYWJzb2x1dGUiKQogICAgICAgICAgLnN0eWxlKCJsZWZ0IiwgYCR7ZXZlbnQucGFnZVggKyAxMH1weGApCiAgICAgICAgICAuc3R5bGUoInRvcCIsIGAke2V2ZW50LnBhZ2VZICsgMTB9cHhgKQogICAgICAgICAgLnN0eWxlKCJkaXNwbGF5IiwgImZsZXgiKQogICAgICAgICAgLnN0eWxlKCJnYXAiLCAiOHB4IikKICAgICAgICAgIC5zdHlsZSgiYm9yZGVyIiwgIjFweCBzb2xpZCAjN0Y3RjdGIikKICAgICAgICAgIC5zdHlsZSgiYmFja2dyb3VuZC1jb2xvciIsICIjRjdGN0Y3IikKICAgICAgICAgIC5zdHlsZSgid2lkdGgiLCAiODZweCIpCiAgICAgICAgICAuc3R5bGUoImhlaWdodCIsICIyNXB4IikKICAgICAgICAgIC5zdHlsZSgicGFkZGluZyIsICIyLjVweCAwIikKICAgICAgICAgIC5zdHlsZSgicGFkZGluZy1sZWZ0IiwgIjhweCIpCiAgICAgICAgICAuc3R5bGUoImJvcmRlci1yYWRpdXMiLCAiOHB4IikKICAgICAgICAgIC5zdHlsZSgiYWxpZ24taXRlbXMiLCAiY2VudGVyIikKICAgICAgICAgIC5zdHlsZSgiei1pbmRleCIsIDEwMDApOwogICAgICAgIG9wdGlvbnMuYXBwZW5kKCJkaXYiKQogICAgICAgICAgLnRleHQoIisiKQogICAgICAgICAgLnN0eWxlKCJmb250LXNpemUiLCAiMjBweCIpCiAgICAgICAgICAuc3R5bGUoImNvbG9yIiwgIiM2NzlENDMiKQogICAgICAgICAgLnN0eWxlKCJib3JkZXItcmFkaXVzIiwgIjUwJSIpCiAgICAgICAgICAuc3R5bGUoIndpZHRoIiwgIjIwcHgiKQogICAgICAgICAgLnN0eWxlKCJoZWlnaHQiLCAiMjBweCIpCiAgICAgICAgICAuc3R5bGUoInRleHQtYWxpZ24iLCAiY2VudGVyIikKICAgICAgICAgIC5zdHlsZSgibGluZS1oZWlnaHQiLCAiMjBweCIpCiAgICAgICAgICAuc3R5bGUoImJhY2tncm91bmQtY29sb3IiLCAiI0Q0RTJDOCIpCiAgICAgICAgICAub24oImNsaWNrIiwgKCkgPT4gY29uc29sZS5sb2coIlBsdXMgY2xpY2tlZCIsIGQpKTsKICAgICAgICBvcHRpb25zLmFwcGVuZCgiZGl2IikKICAgICAgICAgIC50ZXh0KCItIikKICAgICAgICAgIC50ZXh0KCItIikKICAgICAgICAgIC5zdHlsZSgiZm9udC1zaXplIiwgIjIwcHgiKQogICAgICAgICAgLnN0eWxlKCJib3JkZXItcmFkaXVzIiwgIjUwJSIpCiAgICAgICAgICAuc3R5bGUoIndpZHRoIiwgIjIwcHgiKQogICAgICAgICAgLnN0eWxlKCJoZWlnaHQiLCAiMjBweCIpCiAgICAgICAgICAuc3R5bGUoInRleHQtYWxpZ24iLCAiY2VudGVyIikKICAgICAgICAgIC5zdHlsZSgibGluZS1oZWlnaHQiLCAiMjBweCIpCiAgICAgICAgICAuc3R5bGUoImJhY2tncm91bmQtY29sb3IiLCAiI0Q0RTJDOCIpCiAgICAgICAgICAuc3R5bGUoImNvbG9yIiwgIiM2NzlENDMiKQogICAgICAgICAgLm9uKCJjbGljayIsICgpID0+IGNvbnNvbGUubG9nKCJNaW51cyBjbGlja2VkIikpOwogICAgICAgIG9wdGlvbnMuYXBwZW5kKCJkaXYiKQogICAgICAgICAgLnRleHQoIkEiKQogICAgICAgICAgLnN0eWxlKCJmb250LXNpemUiLCAiMTRweCIpCiAgICAgICAgICAuc3R5bGUoImJvcmRlci1yYWRpdXMiLCAiNTAlIikKICAgICAgICAgIC5zdHlsZSgid2lkdGgiLCAiMjBweCIpCiAgICAgICAgICAuc3R5bGUoImhlaWdodCIsICIyMHB4IikKICAgICAgICAgIC5zdHlsZSgidGV4dC1hbGlnbiIsICJjZW50ZXIiKQogICAgICAgICAgLnN0eWxlKCJiYWNrZ3JvdW5kLWNvbG9yIiwgIiNENEUyQzgiKQogICAgICAgICAgLnN0eWxlKCJjb2xvciIsICIjNjc5RDQzIikKICAgICAgICAgIC5vbigiY2xpY2siLCAoKSA9PiB0aGF0LmNvbnZlcnRUb0ltYWdlKGV2ZW50LCBkKSk7CgogICAgICAgIGQzLnNlbGVjdCgiYm9keSIpLm9uKCJjbGljayIsIGZ1bmN0aW9uIChldmVudCkgewogICAgICAgICAgaWYgKCFldmVudC50YXJnZXQuY2xvc2VzdCgnLm9wdGlvbi1ib3gnKSAmJiAhZXZlbnQudGFyZ2V0LmNsb3Nlc3QoJ2NpcmNsZScpKSB7CiAgICAgICAgICAgIGQzLnNlbGVjdEFsbCgnLm9wdGlvbi1ib3gnKS5yZW1vdmUoKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0pOwoKICAgICAgbm9kZS5hcHBlbmQoInRpdGxlIikKICAgICAgICAudGV4dChkID0+IGBJRDogJHtkLmlkfSwgRGlzdGFuY2U6ICR7ZC5kaXN0YW5jZX1gKTsKCiAgICAgIHN2Zy5hcHBlbmQoInRleHQiKQogICAgICAgIC5hdHRyKCJ0cmFuc2Zvcm0iLCBgdHJhbnNsYXRlKDYwLCA1MClgKQogICAgICAgIC5hdHRyKCJmb250LWZhbWlseSIsICJzYW5zLXNlcmlmIikKICAgICAgICAuYXR0cigiZm9udC1zaXplIiwgMTUpCiAgICAgICAgLnRleHQoYFJlY2FsbDogJHtyZWNhbGx9YCk7CgogICAgICBjb25zdCBsZWdlbmQgPSBzdmcuYXBwZW5kKCJnIikKICAgICAgICAuYXR0cigidHJhbnNmb3JtIiwgYHRyYW5zbGF0ZSg2MCwgNjApYCkKICAgICAgICAuYXR0cigiZm9udC1mYW1pbHkiLCAic2Fucy1zZXJpZiIpCiAgICAgICAgLmF0dHIoImZvbnQtc2l6ZSIsIDEwKTsKCiAgICAgIGNvbnN0IHVuaXF1ZUdyb3VwcyA9IFsuLi5uZXcgU2V0KG5vZGVzLm1hcChkID0+IGQuZ3JvdXApKV07CiAgICAgIGNvbnN0IGxlZ2VuZEl0ZW1zID0gbGVnZW5kLnNlbGVjdEFsbCgiZyIpCiAgICAgICAgLmRhdGEodW5pcXVlR3JvdXBzKQogICAgICAgIC5lbnRlcigpLmFwcGVuZCgiZyIpCiAgICAgICAgLmF0dHIoInRyYW5zZm9ybSIsIChkLCBpKSA9PiBgdHJhbnNsYXRlKDAsJHtpICogMjB9KWApOwogICAgICBsZWdlbmRJdGVtcy5hcHBlbmQoInJlY3QiKQogICAgICAgIC5hdHRyKCJ3aWR0aCIsIDE4KQogICAgICAgIC5hdHRyKCJoZWlnaHQiLCAxOCkKICAgICAgICAuYXR0cigiZmlsbCIsIGQgPT4gZ3JvdXBDb2xvck1hcFtkXSk7CgogICAgICBsZWdlbmRJdGVtcy5hcHBlbmQoInRleHQiKQogICAgICAgIC5hdHRyKCJ4IiwgMjQpCiAgICAgICAgLmF0dHIoInkiLCA5KQogICAgICAgIC5hdHRyKCJkeSIsICIwLjM1ZW0iKQogICAgICAgIC50ZXh0KGQgPT4gewogICAgICAgICAgICAgIGlmIChkID09PSAwKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gInN0YXJ0IG5vZGUiOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoZCA9PT0gMSkgewogICAgICAgICAgICAgICAgcmV0dXJuICJub3JtYWwgbm9kZSI7CiAgICAgICAgICAgICAgfSBlbHNlIGlmIChkID09PSAyKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gImd0JnNlYXJjaCBpbnRlcnNlY3Rpb24iOwogICAgICAgICAgICAgIH0gZWxzZSBpZiAoZCA9PT0gMykgewogICAgICAgICAgICAgICAgcmV0dXJuICJzZWFyY2ggb3RoZXIiOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgogICAgICBmdW5jdGlvbiB0aWNrZWQoKSB7CiAgICAgICAgbGluawogICAgICAgICAgLmF0dHIoIngxIiwgZCA9PiBkLnNvdXJjZS54KQogICAgICAgICAgLmF0dHIoInkxIiwgZCA9PiBkLnNvdXJjZS55KQogICAgICAgICAgLmF0dHIoIngyIiwgZCA9PiBkLnRhcmdldC54KQogICAgICAgICAgLmF0dHIoInkyIiwgZCA9PiBkLnRhcmdldC55KTsKICAgICAgICBub2RlCiAgICAgICAgICAuYXR0cigiY3giLCBkID0+IGQueCkKICAgICAgICAgIC5hdHRyKCJjeSIsIGQgPT4gZC55KTsKICAgICAgICBib3JkZXIKICAgICAgICAgIC5hdHRyKCJjeCIsIGQgPT4gZC54KQogICAgICAgICAgLmF0dHIoImN5IiwgZCA9PiBkLnkpOwoKICAgICAgICBsYWJlbHMKICAgICAgICAgIC5hdHRyKCJ4IiwgZCA9PiBkLnggKyAyKQogICAgICAgICAgLmF0dHIoInkiLCBkID0+IGQueSArIDAuMzUpOyAvLyDov5nph4zorr7nva7mlofmnKznmoTkvY3nva4KCiAgICAgICAgdGhhdC51cGRhdGVUaHVtYm5haWwoKTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZHJhZ3N0YXJ0ZWQoZXZlbnQpIHsKICAgICAgICBpZiAoIWV2ZW50LmFjdGl2ZSkgc2ltdWxhdGlvbi5hbHBoYVRhcmdldCgwLjIpLnJlc3RhcnQoKTsKICAgICAgICBldmVudC5zdWJqZWN0LmZ4ID0gZXZlbnQuc3ViamVjdC54OwogICAgICAgIGV2ZW50LnN1YmplY3QuZnkgPSBldmVudC5zdWJqZWN0Lnk7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIGRyYWdnZWQoZXZlbnQpIHsKICAgICAgICBldmVudC5zdWJqZWN0LmZ4ID0gZXZlbnQueDsKICAgICAgICBldmVudC5zdWJqZWN0LmZ5ID0gZXZlbnQueTsKICAgICAgfQoKICAgICAgZnVuY3Rpb24gZHJhZ2VuZGVkKGV2ZW50KSB7CiAgICAgICAgaWYgKCFldmVudC5hY3RpdmUpIHNpbXVsYXRpb24uYWxwaGFUYXJnZXQoMCk7CiAgICAgICAgZXZlbnQuc3ViamVjdC5meCA9IG51bGw7CiAgICAgICAgZXZlbnQuc3ViamVjdC5meSA9IG51bGw7CiAgICAgIH0KCiAgICAgIGZ1bmN0aW9uIHpvb21lZChldmVudCkgewogICAgICAgIGNvbnRhaW5lci5hdHRyKCJ0cmFuc2Zvcm0iLCBldmVudC50cmFuc2Zvcm0pOwogICAgICAgIHRoYXQudXBkYXRlVGh1bWJuYWlsKCk7CiAgICAgIH0KCiAgICB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcFN0YXRlKHsKICAgICAgZGF0YU5vZGVsaW5rOiAiZGF0YU5vZGVMaW5rIiwKICAgICAgcmV0cmlldmFsU2V0OiAicmV0cmlldmFsU2V0IiwKICAgICAgZGF0YXNldE5hbWU6ICJkYXRhc2V0TmFtZSIsCiAgICAgIG1vZGVsTmFtZTogIm1vZGVsTmFtZSIsCiAgICAgIHJldHJpZXZhbEluZm86ICJyZXRyaWV2YWxJbmZvIiwKICAgICAgaXNEb25lOiAiaXNEb25lIgogICAgfSksCiAgfSwKICB3YXRjaDogewoKICAgIC8vIGRhdGFOb2RlbGluayhuZXdWYWwsIG9sZFZhbCkgewogICAgLy8gICBjb25zb2xlLmxvZygi5Y+v5Lul5a6e546w5pu05pawIixuZXdWYWwpOwogICAgLy8gICBpZiAobmV3VmFsICE9PSBvbGRWYWwpIHsKCiAgICAvLyAgIH0KICAgIC8vIH0KCiAgfQp9Owo="},{"version":3,"sources":["NodeLinkView.vue"],"names":[],"mappings":";AAQA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA","file":"NodeLinkView.vue","sourceRoot":"src/views/MainView/MiddleMainView","sourcesContent":["<template>\n  <div v-if=\"this.$store.state.isDone['NodeL']\" class=\"node-link-main\">\n    <svg ref=\"dag\" class=\"dag-svg\"></svg>\n    <svg ref=\"thumbnail\" class=\"thumbnail-svg\"></svg>\n  </div>\n</template>\n\n<script>\nimport * as d3 from \"d3\";\nimport { mapState } from \"vuex\";\nimport api from \"@/api/data\";\n\nexport default {\n  name: \"NodeLinkView\",\n  components: {},\n  data() {\n    return {\n      nodelinkdata: {},\n      svgWidth: 0,  // 页面的宽度\n      svgHeight: 0,   // 页面高度\n      velocityDecay: 0.6,\n      thumbnailWidth: 0, // 缩略图宽度\n      thumbnailHeight: 0, // 缩略图高度\n    };\n  },\n  mounted() {\n    this.getViewSize();\n    this.nodelinkdata = this.$store.state.dataNodeLink;\n    console.log(\"请输出 link data 来看一下连接线的 data\",this.nodelinkdata);\n    this.initGraph(this.nodelinkdata);\n  },\n  methods: {\n    getViewSize() {\n      const dag = this.$refs.dag;\n      this.svgHeight = dag.clientHeight;\n      this.svgWidth = dag.clientWidth;\n      this.thumbnailWidth = this.svgWidth / 5;  // 缩略图宽度和高度分别为整个svg 的1/5\n      this.thumbnailHeight = this.svgHeight / 5;\n      if (this.nodelinkdata.nodes) {\n        this.initGraph(this.nodelinkdata);\n        this.initThumbnail();\n      }\n    },\n    async convertToImage(event, node) {\n      const res = await api.getImageUrl({ \"datasetName\": this.$store.state.datasetName, \"nodeId\": node.id });\n      const imageUrl = res[\"data\"][\"imageUrl\"];\n      const targetElement = d3.select(event.target);\n      const targetBBox = targetElement.node().getBBox();\n      const targetWidth = targetBBox.width;\n      const targetHeight = targetBBox.height;\n      const patternId = `pattern-${node.id}`;\n      let pattern = d3.select(`#${patternId}`);\n      if (pattern.empty()) {\n        const svg = d3.select(`#node-class`);\n        let defs = svg.select(\"defs\").attr(\"width\", targetWidth).attr(\"height\", targetHeight);\n        if (defs.empty()) {\n          defs = svg.append(\"defs\").attr(\"width\", targetWidth).attr(\"height\", targetHeight);\n        }\n        const pattern = defs.append(\"pattern\")\n          .attr(\"id\", patternId)\n          .attr(\"patternUnits\", \"objectBoundingBox\")\n          .attr(\"width\", 1) // 宽度为 1 表示相对于目标元素的宽度\n          .attr(\"height\", 1) // 高度为 1 表示相对于目标元素的高度\n          .attr(\"patternTransform\", \"translate(1, 1)\"); // 向右和向下移动 10 个单位\n\n        const image = pattern.append(\"image\")\n          .attr(\"xlink:href\", imageUrl)\n          .attr(\"width\", 58)\n          .attr(\"height\", 58)\n          .attr(\"preserveAspectRatio\", \"xMidYMid slice\");\n      }\n      targetElement\n        .attr(\"r\", 30)\n        .attr(\"fill\", `url(#pattern-${node.id})`)\n        .attr(\"stroke\", \"#000\") // 设置边框颜色\n        .attr(\"stroke-width\", 2); // 设置边框宽度;\n\n    },\n    initThumbnail() {\n      const thumbnail = d3.select(this.$refs.thumbnail);\n      thumbnail\n        .attr(\"width\", this.thumbnailWidth)\n        .attr(\"height\", this.thumbnailHeight)\n        .attr(\"viewBox\", `0 0 ${this.svgWidth} ${this.svgHeight}`)\n        .attr(\"preserveAspectRatio\", \"xMidYMid meet\")\n        .attr(\"style\", \"position: absolute; bottom: 20px; left: 20px; border: 1px solid #ccc; background: #fff;\");\n    },\n    updateThumbnail() {\n      const that = this;\n      const thumbnail = d3.select(that.$refs.thumbnail);\n      thumbnail.selectAll(\"*\").remove();\n      const container = thumbnail.append(\"g\")\n        .attr(\"transform\", `scale(${that.thumbnailWidth / that.svgWidth}, ${that.thumbnailHeight / that.svgHeight})`);\n\n      // Clone legend and link nodes\n      const legendNode = d3.select(that.$refs.dag).select(\"g.nodes\").node().cloneNode(true);\n      const linkNode = d3.select(that.$refs.dag).select(\"g.link\").node().cloneNode(true);\n      container.append(() => legendNode);\n      container.append(() => linkNode);\n\n    },\n\n    initGraph(data) {\n      const that = this;\n      const width = that.svgWidth;\n      const height = that.svgHeight;\n      const recall = data[\"metric\"]['recall'];\n      const links = data.links.map(d => ({ ...d }));\n      const nodes = data.nodes.map(d => ({ ...d }));\n\n      // 在这里获取 links value 中的最大值和最小值\n      const val = links.map(d => d.value);\n      const minVal = Math.min(...val);\n      const maxVal = Math.max(...val);\n\n      // 定义归一化函数\n      // 定义归一化函数，确保最小值不为 0\n      const normalize = (value) => {\n        const normalizedValue = (value - minVal) / (maxVal - minVal);\n        // 将归一化值范围调整为 [a, 1]，其中 a 为略大于 0 的数值，例如 0.1\n        const a = 0.1;\n        return 10*(normalizedValue * (1 - a) + a);\n      };\n\n      const simulation = d3.forceSimulation(nodes)\n        .force(\"link\", d3.forceLink(links).id(d => d.id))\n        // .distance(d => normalize(d.value)/100000))\n        .force(\"charge\", d3.forceManyBody().strength(-10))\n        .force(\"center\", d3.forceCenter(width / 2, height / 2).strength(0.3))\n        // .force(\"radial\", d3.forceRadial(500, width / 2, height / 2).strength(0.8))\n        // .force(\"x\", d3.forceX(width / 2).strength(0.05))\n        // .force(\"y\", d3.forceY(height / 2).strength(0.05))\n        .velocityDecay(this.velocityDecay)\n        .on(\"tick\", ticked);\n\n      const svg = d3.select(this.$refs.dag);\n      svg.selectAll(\"*\").remove();\n\n      svg.attr(\"viewBox\", `0 0 ${width} ${height}`)\n        .attr(\"width\", \"100%\")\n        .attr(\"height\", \"100%\")\n        .attr(\"preserveAspectRatio\", \"xMidYMid meet\")\n        .attr(\"style\", \"max-width: 100%; height: auto;\")\n        .call(d3.zoom().scaleExtent([0.5, 8]).on(\"zoom\", zoomed));\n\n      const colorMap = d3.scaleOrdinal()\n        .range(['#FF0000', '#A4D3EE', '#FF7F50', '#32CD32']);\n        const groupColorMap = {\n          0: \"#FF0000\",\n          1: \"#A4D3EE\",\n          2: \"#32CD32\",\n          3: \"#FF7F50\",\n        };\n\n      const container = svg.append(\"g\");\n      const link = container.append(\"g\")\n        .attr(\"class\", \"link\")\n        .attr(\"stroke\", \"#999\")\n        .attr(\"stroke-opacity\", 0.6)\n        .selectAll(\"line\")\n        .data(links)\n        .join(\"line\")\n        .attr(\"stroke-width\", d => Math.sqrt(normalize(d.value)))\n        .attr(\"marker-end\", \"url(#arrowhead)\")\n        .attr(\"fill\", d => groupColorMap[d.group]);\n\n      const border = container.append(\"g\")\n        .selectAll(\"circle\")\n        .data(nodes)\n        .join(\"circle\")\n        .attr(\"r\", v => {\n          if (v.group === 0) {\n            return 20;\n          } else if (v.group === 3) {\n            return 15;\n          } else if (v.group === 2) {\n            return 15;\n          } else {\n            return 12.5;\n          }\n        })\n        .attr(\"fill\", \"none\")\n        .attr(\"stroke\", \"none\")\n        .attr(\"stroke-width\", 2);\n\n      const node = container.append(\"g\")\n        .attr(\"class\", \"nodes\")\n        .attr(\"id\", `node-class`)\n        .attr(\"stroke\", \"#fff\")\n        .attr(\"stroke-width\", 0.2)\n        .selectAll(\"circle\")\n        .data(nodes)\n        .join(\"circle\")\n        .attr(\"r\", v => {\n          if (v.group === 0) {\n            return 18;\n          } else if (v.group === 3) {\n            return 13;\n          } else if (v.group === 2) {\n            return 13;\n          } else {\n            return 10.5;\n          }\n        })\n        .attr(\"fill\", d => groupColorMap[d.group])\n        .call(d3.drag()\n          .on(\"start\", dragstarted)\n          .on(\"drag\", dragged)\n          .on(\"end\", dragended));\n\n      const labels = container.append(\"g\")\n        .attr(\"class\", \"labels\")\n        .selectAll(\"text\")\n        .data(nodes)\n        .join(\"text\")\n        .attr(\"dx\", 6)\n        .attr(\"dy\", \".35em\")\n        .style(\"font-size\", \"12px\")  // 设置字体大小\n        .attr(\"stroke\", \"white\")\n        .attr(\"paint-order\", \"stroke\")\n        .text(d => {\n          if (d.group === 2 || d.group === 3) {\n            return `${d.id}`;\n          } else {\n            return \"\";\n          }\n        });\n\n      node.on(\"mouseover\", function (event, d) {\n        border.attr(\"stroke\", (b) => b.id === d.id ? \"#6096E6\" : \"none\");\n      })\n        .on(\"mouseout\", function (event, d) {\n          border.attr(\"stroke\", \"none\");\n        });\n\n      node.on(\"click\", function (event, d) {\n        const existingBox = document.querySelector('.option-box');\n        if (existingBox) {\n          if (parseInt(existingBox.dataset.nodeId) === parseInt(d.id)) {\n            existingBox.remove();\n            return;\n          }\n          existingBox.remove();\n        }\n        const options = d3.select(\"body\").append(\"div\")\n          .attr(\"class\", \"option-box\")\n          .attr(\"data-node-id\", d.id)\n          .style(\"position\", \"absolute\")\n          .style(\"left\", `${event.pageX + 10}px`)\n          .style(\"top\", `${event.pageY + 10}px`)\n          .style(\"display\", \"flex\")\n          .style(\"gap\", \"8px\")\n          .style(\"border\", \"1px solid #7F7F7F\")\n          .style(\"background-color\", \"#F7F7F7\")\n          .style(\"width\", \"86px\")\n          .style(\"height\", \"25px\")\n          .style(\"padding\", \"2.5px 0\")\n          .style(\"padding-left\", \"8px\")\n          .style(\"border-radius\", \"8px\")\n          .style(\"align-items\", \"center\")\n          .style(\"z-index\", 1000);\n        options.append(\"div\")\n          .text(\"+\")\n          .style(\"font-size\", \"20px\")\n          .style(\"color\", \"#679D43\")\n          .style(\"border-radius\", \"50%\")\n          .style(\"width\", \"20px\")\n          .style(\"height\", \"20px\")\n          .style(\"text-align\", \"center\")\n          .style(\"line-height\", \"20px\")\n          .style(\"background-color\", \"#D4E2C8\")\n          .on(\"click\", () => console.log(\"Plus clicked\", d));\n        options.append(\"div\")\n          .text(\"-\")\n          .text(\"-\")\n          .style(\"font-size\", \"20px\")\n          .style(\"border-radius\", \"50%\")\n          .style(\"width\", \"20px\")\n          .style(\"height\", \"20px\")\n          .style(\"text-align\", \"center\")\n          .style(\"line-height\", \"20px\")\n          .style(\"background-color\", \"#D4E2C8\")\n          .style(\"color\", \"#679D43\")\n          .on(\"click\", () => console.log(\"Minus clicked\"));\n        options.append(\"div\")\n          .text(\"A\")\n          .style(\"font-size\", \"14px\")\n          .style(\"border-radius\", \"50%\")\n          .style(\"width\", \"20px\")\n          .style(\"height\", \"20px\")\n          .style(\"text-align\", \"center\")\n          .style(\"background-color\", \"#D4E2C8\")\n          .style(\"color\", \"#679D43\")\n          .on(\"click\", () => that.convertToImage(event, d));\n\n        d3.select(\"body\").on(\"click\", function (event) {\n          if (!event.target.closest('.option-box') && !event.target.closest('circle')) {\n            d3.selectAll('.option-box').remove();\n          }\n        });\n\n        event.stopPropagation();\n      });\n\n      node.append(\"title\")\n        .text(d => `ID: ${d.id}, Distance: ${d.distance}`);\n\n      svg.append(\"text\")\n        .attr(\"transform\", `translate(60, 50)`)\n        .attr(\"font-family\", \"sans-serif\")\n        .attr(\"font-size\", 15)\n        .text(`Recall: ${recall}`);\n\n      const legend = svg.append(\"g\")\n        .attr(\"transform\", `translate(60, 60)`)\n        .attr(\"font-family\", \"sans-serif\")\n        .attr(\"font-size\", 10);\n\n      const uniqueGroups = [...new Set(nodes.map(d => d.group))];\n      const legendItems = legend.selectAll(\"g\")\n        .data(uniqueGroups)\n        .enter().append(\"g\")\n        .attr(\"transform\", (d, i) => `translate(0,${i * 20})`);\n      legendItems.append(\"rect\")\n        .attr(\"width\", 18)\n        .attr(\"height\", 18)\n        .attr(\"fill\", d => groupColorMap[d]);\n\n      legendItems.append(\"text\")\n        .attr(\"x\", 24)\n        .attr(\"y\", 9)\n        .attr(\"dy\", \"0.35em\")\n        .text(d => {\n              if (d === 0) {\n                return \"start node\";\n              } else if (d === 1) {\n                return \"normal node\";\n              } else if (d === 2) {\n                return \"gt&search intersection\";\n              } else if (d === 3) {\n                return \"search other\";\n              }\n            });\n\n      function ticked() {\n        link\n          .attr(\"x1\", d => d.source.x)\n          .attr(\"y1\", d => d.source.y)\n          .attr(\"x2\", d => d.target.x)\n          .attr(\"y2\", d => d.target.y);\n        node\n          .attr(\"cx\", d => d.x)\n          .attr(\"cy\", d => d.y);\n        border\n          .attr(\"cx\", d => d.x)\n          .attr(\"cy\", d => d.y);\n\n        labels\n          .attr(\"x\", d => d.x + 2)\n          .attr(\"y\", d => d.y + 0.35); // 这里设置文本的位置\n\n        that.updateThumbnail();\n      }\n\n      function dragstarted(event) {\n        if (!event.active) simulation.alphaTarget(0.2).restart();\n        event.subject.fx = event.subject.x;\n        event.subject.fy = event.subject.y;\n      }\n\n      function dragged(event) {\n        event.subject.fx = event.x;\n        event.subject.fy = event.y;\n      }\n\n      function dragended(event) {\n        if (!event.active) simulation.alphaTarget(0);\n        event.subject.fx = null;\n        event.subject.fy = null;\n      }\n\n      function zoomed(event) {\n        container.attr(\"transform\", event.transform);\n        that.updateThumbnail();\n      }\n\n    },\n  },\n  computed: {\n    ...mapState({\n      dataNodelink: \"dataNodeLink\",\n      retrievalSet: \"retrievalSet\",\n      datasetName: \"datasetName\",\n      modelName: \"modelName\",\n      retrievalInfo: \"retrievalInfo\",\n      isDone: \"isDone\"\n    }),\n  },\n  watch: {\n\n    // dataNodelink(newVal, oldVal) {\n    //   console.log(\"可以实现更新\",newVal);\n    //   if (newVal !== oldVal) {\n\n    //   }\n    // }\n\n  }\n};\n</script>\n\n<style scoped lang=\"scss\">\n.node-link-main {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  position: relative;\n\n  .dag-svg {\n    height: 100%;\n    width: 100%;\n  }\n\n  .thumbnail-svg {\n    position: absolute;\n    bottom: 20px;\n    left: 20px;\n    border: 1px solid #ccc;\n    background: #fff;\n  }\n}\n\n.option-box {\n  border: 1px solid #F7F7F7;\n  background-color: #F7F7F7;\n  padding: 5px;\n  position: absolute;\n  z-index: 1000;\n\n  div {\n    margin: 2px 0;\n    cursor: pointer;\n  }\n\n  div:hover {\n    background-color: #f0f0f0;\n  }\n}\n\n.option-button {\n  padding: 5px 10px;\n  border: 1px solid #000;\n  border-radius: 5px;\n  cursor: pointer;\n  background-color: #f0f0f0;\n  font-size: 14px;\n  font-family: Arial, sans-serif;\n  color: red;\n}\n\n.option-button:hover {\n  background-color: #e0e0e0;\n}\n</style>"]}]}