{"remainingRequest":"/home/yansha/VDProject/VDFrontend/node_modules/babel-loader/lib/index.js!/home/yansha/VDProject/VDFrontend/node_modules/babel-loader/lib/index.js??ref--17!/home/yansha/VDProject/VDFrontend/src/components/Embedding/EmbeddingPointWebGL.js","dependencies":[{"path":"/home/yansha/VDProject/VDFrontend/src/components/Embedding/EmbeddingPointWebGL.js","mtime":1744442733392},{"path":"/home/yansha/VDProject/VDFrontend/babel.config.js","mtime":1744442733384},{"path":"/home/yansha/VDProject/VDFrontend/babel.config.js","mtime":1744442733384},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/cache-loader/dist/cjs.js","mtime":1735202380381},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/babel-loader/lib/index.js","mtime":1735202380921},{"path":"/home/yansha/VDProject/VDFrontend/node_modules/babel-loader/lib/index.js","mtime":1735202380921}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5wdXNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucmVkdWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lml0ZXJhdG9yLmNvbnN0cnVjdG9yLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lml0ZXJhdG9yLmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5pdGVyYXRvci5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuaXRlcmF0b3IucmVkdWNlLmpzIjsKaW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIi9ob21lL3lhbnNoYS9WRFByb2plY3QvVkRGcm9udGVuZC9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmVycm9yLmNhdXNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LnJlZHVjZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5pdGVyYXRvci5jb25zdHJ1Y3Rvci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC5pdGVyYXRvci5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQuaXRlcmF0b3IubWFwLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0Lml0ZXJhdG9yLnJlZHVjZS5qcyI7CmltcG9ydCBkMyBmcm9tICcuLi8uLi91dGlscy9kMy1pbXBvcnQnOwppbXBvcnQgeyBjb25maWcgfSBmcm9tICcuLi8uLi9jb25maWcvY29uZmlnJzsKaW1wb3J0IHsgdXBkYXRlUG9wcGVyVG9vbHRpcCB9IGZyb20gJy4vRW1iZWRkaW5nTGFiZWwnOwppbXBvcnQgZnJhZ21lbnRTaGFkZXIgZnJvbSAnLi9zaGFkZXJzL3BvaW50LmZyYWc/cmF3JzsKaW1wb3J0IHZlcnRleFNoYWRlciBmcm9tICcuL3NoYWRlcnMvcG9pbnQudmVydD9yYXcnOwppbXBvcnQgKiBhcyBMYWJlbGVyIGZyb20gJy4vRW1iZWRkaW5nTGFiZWwnOwppbXBvcnQgZWRnZUZyYWdtZW50U2hhZGVyIGZyb20gJy4vc2hhZGVycy9lZGdlLmZyYWc/cmF3JzsKaW1wb3J0IGVkZ2VWZXJ0ZXhTaGFkZXIgZnJvbSAnLi9zaGFkZXJzL2VkZ2UudmVydD9yYXcnOwp2YXIgcG9pbnRNb3VzZWVudGVyVGltZXIgPSBudWxsOwp2YXIgcG9pbnRNb3VzZWxlYXZlVGltZXIgPSBudWxsOwpleHBvcnQgZnVuY3Rpb24gaW5pdFdlYkdMTWF0cmljZXModGhhdCkgewogIC8vIENvbnZlcnQgdGhlIHggYW5kIHkgc2NhbGVzIHRvIGEgbWF0cml4IChhcHBseWluZyBzY2FsZSBpcyBjaGVhcGVyIGluIEdQVSkKCiAgdmFyIHhEb21haW5NaWQgPSAodGhhdC54U2NhbGUuZG9tYWluKClbMF0gKyB0aGF0LnhTY2FsZS5kb21haW4oKVsxXSkgLyAyOwogIHZhciB5RG9tYWluTWlkID0gKHRoYXQueVNjYWxlLmRvbWFpbigpWzBdICsgdGhhdC55U2NhbGUuZG9tYWluKClbMV0pIC8gMjsKICB2YXIgeFJhbmdlTWlkID0gKHRoYXQueFNjYWxlLnJhbmdlKClbMF0gKyB0aGF0LnhTY2FsZS5yYW5nZSgpWzFdKSAvIDI7CiAgdmFyIHlSYW5nZU1pZCA9ICh0aGF0LnlTY2FsZS5yYW5nZSgpWzBdICsgdGhhdC55U2NhbGUucmFuZ2UoKVsxXSkgLyAyOwogIHZhciB4TXVsdGlwbGllciA9ICh0aGF0LnhTY2FsZS5yYW5nZSgpWzFdIC0gdGhhdC54U2NhbGUucmFuZ2UoKVswXSkgLyAodGhhdC54U2NhbGUuZG9tYWluKClbMV0gLSB0aGF0LnhTY2FsZS5kb21haW4oKVswXSk7CiAgdmFyIHlNdWx0aXBsaWVyID0gKHRoYXQueVNjYWxlLnJhbmdlKClbMV0gLSB0aGF0LnlTY2FsZS5yYW5nZSgpWzBdKSAvICh0aGF0LnlTY2FsZS5kb21haW4oKVsxXSAtIHRoYXQueVNjYWxlLmRvbWFpbigpWzBdKTsKCiAgLy8gV2ViR0wgaXMgY29sdW1uLW1ham9yIQogIC8vIFRyYW5zZm9ybSBmcm9tIGRhdGEgc3BhY2UgdG8gc3RhZ2Ugc3BhY2UgKHNhbWUgYXMgYXBwbHlpbmcgdGhhdC54U2NhbGUoKSwKICAvLyBhbmQgdGhhdC55U2NhbGUoKSkKCiAgdmFyIGRhdGFTY2FsZU1hdHJpeCA9IFtbeE11bHRpcGxpZXIsIDAsIC14TXVsdGlwbGllciAqIHhEb21haW5NaWQgKyB4UmFuZ2VNaWRdLCBbMCwgeU11bHRpcGxpZXIsIC15TXVsdGlwbGllciAqIHlEb21haW5NaWQgKyB5UmFuZ2VNaWRdLCBbMCwgMCwgMV1dOwoKICAvLyDpgILlvZPosIPmlbTlubPnp7vph4/vvIzkvb/lvpfnu5jlm77ljLrln5/nmoTkuK3lv4PkuI7op4blm77nmoTkuK3lv4Plr7npvZAKICAvLyBkYXRhU2NhbGVNYXRyaXhbMF1bMl0gKz0gKHRoYXQuc3ZnRnVsbFNpemUud2lkdGggLyAyIC0geFJhbmdlTWlkKTsKICAvLyBkYXRhU2NhbGVNYXRyaXhbMV1bMl0gKz0gKHRoYXQuc3ZnRnVsbFNpemUuaGVpZ2h0IC8gMiAtIHlSYW5nZU1pZCk7CiAgdmFyIGRhdGFTY2FsZU1hdHJpeDFEID0gZGF0YVNjYWxlTWF0cml4LmZsYXQoKTsKCiAgLy8gVHJhbnNmb3JtaW5nIHRoZSBzdGFnZSBzcGFjZSB0byB0aGUgbm9ybWFsaXplZCBjb29yZGluYXRlCiAgLy8gTm90ZSB3ZSBuZWVkIHRvIGZsaXAgdGhlIHkgY29vcmRpbmF0ZQogIHZhciBub3JtYWxpemVNYXRyaXggPSBbWzIgLyB0aGF0LnN2Z0Z1bGxTaXplLndpZHRoLCAwLCAtMV0sIFswLCAtMiAvIHRoYXQuc3ZnRnVsbFNpemUuaGVpZ2h0LCAxXSwgWzAsIDAsIDFdXTsKICB2YXIgbm9ybWFsaXplTWF0cml4MUQgPSBub3JtYWxpemVNYXRyaXguZmxhdCgpOwoKICAvLyDlsIbmiYDmnInnn6npmLXlrZjlgqjlnKggd2ViR0xNYXRyaWNlcyDlr7nosaHkuK0KICB0aGF0LndlYkdMTWF0cmljZXMgPSB7CiAgICBkYXRhU2NhbGVNYXRyaXg6IGRhdGFTY2FsZU1hdHJpeDFELAogICAgbm9ybWFsaXplTWF0cml4OiBub3JtYWxpemVNYXRyaXgxRAogIH07Cn0KZXhwb3J0IGZ1bmN0aW9uIGluaXRXZWJHTEJ1ZmZlcnModGhhdCkgewogIGlmICh0aGF0LmdyaWREYXRhID09PSBudWxsKSB7CiAgICB0aHJvdyBuZXcgRXJyb3IoJ0dyaWREYXRhIGlzIG51bGwuJyk7CiAgfQoKICAvLyDojrflj5bmr4/kuKrngrnnmoTkvY3nva7lkozpopzoibIKICB2YXIgcG9zaXRpb25zID0gW107CiAgdmFyIHRleHR1cmVDb29yZHMgPSBbXTsKICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIodGhhdC5wcm9tcHRQb2ludHMpLAogICAgX3N0ZXA7CiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBwb2ludCA9IF9zdGVwLnZhbHVlOwogICAgICBwb3NpdGlvbnMucHVzaChbcG9pbnQueCwgcG9pbnQueV0pOwogICAgICB0ZXh0dXJlQ29vcmRzLnB1c2goWzAsIDBdKTsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvci5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvci5mKCk7CiAgfQogIHZhciB0b3RhbFBvaW50U2l6ZSA9IHRoYXQuZ3JpZERhdGEudG90YWxQb2ludFNpemU7CiAgdGhhdC5mcm9udFBvc2l0aW9uQnVmZmVyID0gdGhhdC5wb2ludFJlZ2wuYnVmZmVyKHsKICAgIGxlbmd0aDogdG90YWxQb2ludFNpemUgKiA0ICogMiwKICAgIHR5cGU6ICdmbG9hdCcsCiAgICB1c2FnZTogJ2R5bmFtaWMnCiAgfSk7CiAgdGhhdC5mcm9udFBvc2l0aW9uQnVmZmVyLnN1YmRhdGEocG9zaXRpb25zLCAwKTsKICB0aGF0LmZyb250VGV4dHVyZUNvb3JkaW5hdGVCdWZmZXIgPSB0aGF0LnBvaW50UmVnbC5idWZmZXIoewogICAgbGVuZ3RoOiB0b3RhbFBvaW50U2l6ZSAqIDQgKiAyLAogICAgdHlwZTogJ2Zsb2F0JywKICAgIHVzYWdlOiAnZHluYW1pYycKICB9KTsKICB0aGF0LmZyb250VGV4dHVyZUNvb3JkaW5hdGVCdWZmZXIuc3ViZGF0YSh0ZXh0dXJlQ29vcmRzLCAwKTsKICB0aGF0LmZyb250QnVmZmVyUG9pbnRTaXplID0gdGhhdC5wcm9tcHRQb2ludHMubGVuZ3RoOwp9CgovKioKICogRHJhdyBhIHNjYXR0ZXIgcGxvdCBmb3IgdGhlIFVNQVAuCiAqLwpleHBvcnQgZnVuY3Rpb24gZHJhd1NjYXR0ZXJQbG90KHRoYXQpIHsKICBpZiAoIXRoYXQud2ViR0xNYXRyaWNlcykgewogICAgdGhyb3cgRXJyb3IoJ3dlYkdMTWF0cmljZXMgbm90IGluaXRpYWxpemVkJyk7CiAgfQogIHRoYXQucG9pbnRSZWdsLmNsZWFyKHsKICAgIGNvbG9yOiBbMCwgMCwgMCwgMF0sCiAgICBkZXB0aDogMQogIH0pOwoKICAvLyBBZGp1c3QgcG9pbnQgd2lkdGggYmFzZWQgb24gdGhlIG51bWJlciBvZiBwb2ludHMgdG8gZHJhdwogIHZhciBwb2ludENvdW50ID0gdGhhdC5sb2FkZWRQb2ludENvdW50OwoKICAvLyBMb2dhcml0aG1pYyByZWdyZXNzaW9uIGJ5IGZpdHRpbmcgdGhlIGZvbGxvd2luZyB0aHJlZSBwb2ludHMKICAvLyBodHRwczovL2tlaXNhbi5jYXNpby5jb20vZXhlYy9zeXN0ZW0vMTQwNTk5MzAyMjY2OTEKICAvLyBbKDZlNCwgMiksICgzZTUsIDEpLCBbMS44ZTYsIDAuNV1dCiAgdmFyIGEgPSA2LjcxNjgyMDcxOwogIHZhciBiID0gLTAuNDM3OTc0ODcxOwogIHRoYXQuY3VyUG9pbnRXaWR0aCA9IGEgKyBiICogTWF0aC5sb2coY29uZmlnLmxheW91dC5zY2F0dGVyRG90UmFkaXVzICogKHRoYXQuc3ZnRnVsbFNpemUuaGVpZ2h0IC8gMTAwMDAwMDApICogcG9pbnRDb3VudCk7CiAgdGhhdC5jdXJQb2ludFdpZHRoID0gTWF0aC5taW4oNSwgdGhhdC5jdXJQb2ludFdpZHRoKTsKICB0aGF0LmN1clBvaW50V2lkdGggPSBNYXRoLm1heCgwLjQsIHRoYXQuY3VyUG9pbnRXaWR0aCk7CiAgdmFyIGFscGhhID0gMSAvIChNYXRoLmxvZyhwb2ludENvdW50KSAvIE1hdGgubG9nKDUwMCkpOwoKICAvLyBHZXQgdGhlIGN1cnJlbnQgem9vbQogIHZhciB6b29tTWF0cml4ID0gZ2V0Wm9vbU1hdHJpeCh0aGF0LmN1clpvb21UcmFuc2Zvcm0pOwoKICAvLyBDcmVhdGUgYSB0ZXh0dXJlIGFycmF5IChkZWZhdWx0IDN4MSkKICB2YXIgdGV4dHVyZUFycmF5ID0gW2NvbmZpZy5sYXlvdXQuZGVmYXVsdFBvaW50Q29sb3JJbnRbMF0sIGNvbmZpZy5sYXlvdXQuZGVmYXVsdFBvaW50Q29sb3JJbnRbMV0sIGNvbmZpZy5sYXlvdXQuZGVmYXVsdFBvaW50Q29sb3JJbnRbMl0sIDI1NSwgY29uZmlnLmxheW91dC5zZWNvbmRQb2ludENvbG9ySW50WzBdLCBjb25maWcubGF5b3V0LnNlY29uZFBvaW50Q29sb3JJbnRbMV0sIGNvbmZpZy5sYXlvdXQuc2Vjb25kUG9pbnRDb2xvckludFsyXSwgMjU1LCAyNTUsIDI1NSwgMjU1LCAwXTsKICAvLyBbZGVmYXVsdCBjb2xvciwgc2Vjb25kIGNvbG9yLCB0cmFuc3BhcmVudCwgZW1wdHldCiAgdmFyIHRleHR1cmUgPSB0aGF0LnBvaW50UmVnbC50ZXh0dXJlKHsKICAgIHdpZHRoOiAzLAogICAgaGVpZ2h0OiAxLAogICAgZGF0YTogdGV4dHVyZUFycmF5LAogICAgZm9ybWF0OiAncmdiYScKICB9KTsKCiAgLy8gSWYgdXNlciBzcGVjaWZpZXMgYW4gYWxwaGEgbGV2ZWwsIHdlIHVzZSBpdCB0byBvdmVycmlkZSBhdXRvLWFscGhhCiAgdmFyIHVzZXJBbHBoYSA9IC0xLjA7CiAgaWYgKHRoYXQuZ3JpZERhdGEgJiYgdGhhdC5ncmlkRGF0YS5vcGFjaXR5ICE9PSB1bmRlZmluZWQpIHsKICAgIHVzZXJBbHBoYSA9IE1hdGgubWF4KDAsIE1hdGgubWluKHRoYXQuZ3JpZERhdGEub3BhY2l0eSwgMSkpOwogIH0KICB2YXIgZHJhd1BvaW50cyA9IHRoYXQucG9pbnRSZWdsKHsKICAgIGRlcHRoOiB7CiAgICAgIGVuYWJsZTogZmFsc2UKICAgIH0sCiAgICBzdGVuY2lsOiB7CiAgICAgIGVuYWJsZTogZmFsc2UKICAgIH0sCiAgICBmcmFnOiBmcmFnbWVudFNoYWRlciwKICAgIHZlcnQ6IHZlcnRleFNoYWRlciwKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcG9zaXRpb246IHsKICAgICAgICBidWZmZXI6IHRoYXQuZnJvbnRQb3NpdGlvbkJ1ZmZlciwKICAgICAgICBzdHJpZGU6IDIgKiA0LAogICAgICAgIG9mZnNldDogMAogICAgICB9LAogICAgICB0ZXh0dXJlQ29vcmQ6IHsKICAgICAgICBidWZmZXI6IHRoYXQuZnJvbnRUZXh0dXJlQ29vcmRpbmF0ZUJ1ZmZlciwKICAgICAgICBzdHJpZGU6IDIgKiA0LAogICAgICAgIG9mZnNldDogMAogICAgICB9CiAgICB9LAogICAgdW5pZm9ybXM6IHsKICAgICAgLy8gUGxhY2Vob2xkZXIgZm9yIGZ1bmN0aW9uIHBhcmFtZXRlcnMKICAgICAgcG9pbnRXaWR0aDogMS4yLAogICAgICBkYXRhU2NhbGVNYXRyaXg6IHRoYXQud2ViR0xNYXRyaWNlcy5kYXRhU2NhbGVNYXRyaXgsCiAgICAgIHpvb21NYXRyaXg6IHpvb21NYXRyaXgsCiAgICAgIG5vcm1hbGl6ZU1hdHJpeDogdGhhdC53ZWJHTE1hdHJpY2VzLm5vcm1hbGl6ZU1hdHJpeCwKICAgICAgYWxwaGE6IGFscGhhLAogICAgICB1c2VyQWxwaGE6IHVzZXJBbHBoYSwKICAgICAgdGV4dHVyZTogdGV4dHVyZQogICAgfSwKICAgIGJsZW5kOiB7CiAgICAgIGVuYWJsZTogdHJ1ZSwKICAgICAgZnVuYzogewogICAgICAgIHNyY1JHQjogJ29uZScsCiAgICAgICAgc3JjQWxwaGE6ICdvbmUnLAogICAgICAgIGRzdFJHQjogJ29uZSBtaW51cyBzcmMgYWxwaGEnLAogICAgICAgIGRzdEFscGhhOiAnb25lIG1pbnVzIHNyYyBhbHBoYScKICAgICAgfQogICAgfSwKICAgIGNvdW50OiB0aGF0LmZyb250QnVmZmVyUG9pbnRTaXplLAogICAgcHJpbWl0aXZlOiAncG9pbnRzJwogIH0pOwogIGRyYXdQb2ludHMoKTsKfQpleHBvcnQgZnVuY3Rpb24gZHJhd0NvbnRvdXIodGhhdCkgewogIGlmICh0aGF0LmdyaWREYXRhID09IG51bGwpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ0dyaWQgZGF0YSBub3QgaW5pdGlhbGl6ZWQnKTsKICAgIHJldHVybiBudWxsOwogIH0KICB2YXIgY29udG91ckdyb3VwID0gdGhhdC5zdmcuc2VsZWN0KCIuY29udG91ci1ncm91cCIpOwogIHZhciBncmlkRGF0YTFEID0gW107CiAgdmFyIGdyaWQgPSB0aGF0LmdyaWREYXRhLmdyaWQ7CiAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihncmlkKSwKICAgIF9zdGVwMjsKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgdmFyIHJvdyA9IF9zdGVwMi52YWx1ZTsKICAgICAgdmFyIF9pdGVyYXRvcjMgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyb3cpLAogICAgICAgIF9zdGVwMzsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjMucygpOyAhKF9zdGVwMyA9IF9pdGVyYXRvcjMubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcDMudmFsdWU7CiAgICAgICAgICBncmlkRGF0YTFELnB1c2goaXRlbSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IzLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IzLmYoKTsKICAgICAgfQogICAgfQoKICAgIC8vIExpbmVhciBpbnRlcnBvbGF0ZSB0aGUgbGV2ZWxzIHRvIGRldGVybWluZSB0aGUgdGhyZXNob2xkcwogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yMi5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjIuZigpOwogIH0KICB2YXIgbGV2ZWxzID0gY29uZmlnLmxheW91dC5jb250b3VyTGV2ZWxzOwogIHZhciB0aHJlc2hvbGRzID0gW107CiAgdmFyIG1pblZhbHVlID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgZ3JpZERhdGExRCk7CiAgdmFyIG1heFZhbHVlID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgZ3JpZERhdGExRCk7CiAgdmFyIHN0ZXAgPSAobWF4VmFsdWUgLSBtaW5WYWx1ZSkgLyBsZXZlbHM7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZXZlbHM7IGkrKykgewogICAgdGhyZXNob2xkcy5wdXNoKG1pblZhbHVlICsgc3RlcCAqIGkpOwogIH0KICB2YXIgY29udG91cnMgPSBkMy5jb250b3VycygpLnRocmVzaG9sZHModGhyZXNob2xkcykuc2l6ZShbZ3JpZC5sZW5ndGgsIGdyaWRbMF0ubGVuZ3RoXSkoZ3JpZERhdGExRCk7CgogIC8vIENvbnZlcnQgdGhlIHNjYWxlIG9mIHRoZSBnZW5lcmF0ZWQgcGF0aHMKICB2YXIgY29udG91clhTY2FsZSA9IGQzLnNjYWxlTGluZWFyKCkuZG9tYWluKFswLCBncmlkLmxlbmd0aF0pLnJhbmdlKHRoYXQuZ3JpZERhdGEueFJhbmdlKTsKICB2YXIgY29udG91cllTY2FsZSA9IGQzLnNjYWxlTGluZWFyKCkuZG9tYWluKFswLCBncmlkWzBdLmxlbmd0aF0pLnJhbmdlKHRoYXQuZ3JpZERhdGEueVJhbmdlKTsKICBjb250b3VycyA9IGNvbnRvdXJzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgaXRlbS5jb29yZGluYXRlcyA9IGl0ZW0uY29vcmRpbmF0ZXMubWFwKGZ1bmN0aW9uIChjb29yZGluYXRlcykgewogICAgICByZXR1cm4gY29vcmRpbmF0ZXMubWFwKGZ1bmN0aW9uIChwb3NpdGlvbnMpIHsKICAgICAgICByZXR1cm4gcG9zaXRpb25zLm1hcChmdW5jdGlvbiAocG9pbnQpIHsKICAgICAgICAgIHJldHVybiBbdGhhdC54U2NhbGUoY29udG91clhTY2FsZShwb2ludFswXSkpLAogICAgICAgICAgLy8gdGhhdC54U2NhbGUoY29udG91clhTY2FsZShwb2ludFswXSkpICsgKHRoYXQuc3ZnRnVsbFNpemUud2lkdGggLSB0aGF0LnN2Z0Z1bGxTaXplLmhlaWdodCkgLyAyLAogICAgICAgICAgdGhhdC55U2NhbGUoY29udG91cllTY2FsZShwb2ludFsxXSkpXTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiBpdGVtOwogIH0pOwoKICAvLyBDcmVhdGUgYSBuZXcgY29sb3IgaW50ZXJwb2xhdG9yCiAgLy8gKHN0YXJ0aW5nIGZyb20gd2hpdGUgaGVyZSkKICB2YXIgY29sb3JTY2FsZUludGVycG9sYXRvciA9IGQzLmludGVycG9sYXRlTGFiKCcjZmZmZmZmJywgY29uZmlnLmxheW91dFsnZ3JvdXBDb2xvcnMnXVswXSk7CiAgdmFyIGNvbG9yU2NhbGUgPSBkMy5zY2FsZVNlcXVlbnRpYWwoZDMuZXh0ZW50KHRocmVzaG9sZHMpLCBmdW5jdGlvbiAoZCkgewogICAgcmV0dXJuIGNvbG9yU2NhbGVJbnRlcnBvbGF0b3IoZCAvIDEpOwogIH0pOwoKICAvLyBEcmF3IHRoZSBjb250b3VycwogIGNvbnRvdXJHcm91cC5zZWxlY3RBbGwoJ3BhdGgnKS5kYXRhKGNvbnRvdXJzLnNsaWNlKDEpKS5qb2luKCdwYXRoJykuYXR0cignZmlsbCcsIGZ1bmN0aW9uIChkKSB7CiAgICByZXR1cm4gY29sb3JTY2FsZShkLnZhbHVlKTsKICB9KS5hdHRyKCdkJywgZDMuZ2VvUGF0aCgpKTsKICByZXR1cm4gY29udG91cnM7Cn0KOwpleHBvcnQgZnVuY3Rpb24gZHJhd0dyb3VwQ29udG91cih0aGF0LCBncm91cCkgewogIHZhciBfdGhhdCRncm91cE5hbWVzOwogIGlmICh0aGF0LmdyaWREYXRhID09IG51bGwgfHwgdGhhdC5ncmlkRGF0YS5ncm91cEdyaWRzID09IHVuZGVmaW5lZCkgewogICAgY29uc29sZS5lcnJvcignR3JpZCBkYXRhIG5vdCBpbml0aWFsaXplZCcsIHRoYXQuZ3JpZERhdGEpOwogICAgcmV0dXJuIG51bGw7CiAgfQogIHZhciBjb250b3VyR3JvdXAgPSB0aGF0LnN2Zy5zZWxlY3QoIi5jb250b3VyLWdyb3VwLSIuY29uY2F0KGdyb3VwKSk7CiAgdmFyIGdyaWREYXRhMUQgPSBbXTsKICB2YXIgZ3JpZCA9IHRoYXQuZ3JpZERhdGEuZ3JvdXBHcmlkc1tncm91cF07CiAgdmFyIF9pdGVyYXRvcjQgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihncmlkKSwKICAgIF9zdGVwNDsKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3I0LnMoKTsgIShfc3RlcDQgPSBfaXRlcmF0b3I0Lm4oKSkuZG9uZTspIHsKICAgICAgdmFyIHJvdyA9IF9zdGVwNC52YWx1ZTsKICAgICAgdmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihyb3cpLAogICAgICAgIF9zdGVwNTsKICAgICAgdHJ5IHsKICAgICAgICBmb3IgKF9pdGVyYXRvcjUucygpOyAhKF9zdGVwNSA9IF9pdGVyYXRvcjUubigpKS5kb25lOykgewogICAgICAgICAgdmFyIGl0ZW0gPSBfc3RlcDUudmFsdWU7CiAgICAgICAgICBncmlkRGF0YTFELnB1c2goaXRlbSk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3I1LmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3I1LmYoKTsKICAgICAgfQogICAgfQoKICAgIC8vIExpbmVhciBpbnRlcnBvbGF0ZSB0aGUgbGV2ZWxzIHRvIGRldGVybWluZSB0aGUgdGhyZXNob2xkcwogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yNC5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjQuZigpOwogIH0KICB2YXIgbGV2ZWxzID0gY29uZmlnLmxheW91dC5jb250b3VyTGV2ZWxzOwogIHZhciB0aHJlc2hvbGRzID0gW107CiAgdmFyIG1pblZhbHVlID0gTWF0aC5taW4uYXBwbHkoTWF0aCwgZ3JpZERhdGExRCk7CiAgdmFyIG1heFZhbHVlID0gTWF0aC5tYXguYXBwbHkoTWF0aCwgZ3JpZERhdGExRCk7CiAgdmFyIHN0ZXAgPSAobWF4VmFsdWUgLSBtaW5WYWx1ZSkgLyBsZXZlbHM7CiAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZXZlbHM7IGkrKykgewogICAgdGhyZXNob2xkcy5wdXNoKG1pblZhbHVlICsgc3RlcCAqIGkpOwogIH0KICB2YXIgY29udG91cnMgPSBkMy5jb250b3VycygpLnRocmVzaG9sZHModGhyZXNob2xkcykuc2l6ZShbZ3JpZC5sZW5ndGgsIGdyaWRbMF0ubGVuZ3RoXSkoZ3JpZERhdGExRCk7CgogIC8vIENvbnZlcnQgdGhlIHNjYWxlIG9mIHRoZSBnZW5lcmF0ZWQgcGF0aHMKICB2YXIgY29udG91clhTY2FsZSA9IGQzLnNjYWxlTGluZWFyKCkuZG9tYWluKFswLCBncmlkLmxlbmd0aF0pLnJhbmdlKHRoYXQuZ3JpZERhdGEueFJhbmdlKTsKICB2YXIgY29udG91cllTY2FsZSA9IGQzLnNjYWxlTGluZWFyKCkuZG9tYWluKFswLCBncmlkWzBdLmxlbmd0aF0pLnJhbmdlKHRoYXQuZ3JpZERhdGEueVJhbmdlKTsKICBjb250b3VycyA9IGNvbnRvdXJzLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgaXRlbS5jb29yZGluYXRlcyA9IGl0ZW0uY29vcmRpbmF0ZXMubWFwKGZ1bmN0aW9uIChjb29yZGluYXRlcykgewogICAgICByZXR1cm4gY29vcmRpbmF0ZXMubWFwKGZ1bmN0aW9uIChwb3NpdGlvbnMpIHsKICAgICAgICByZXR1cm4gcG9zaXRpb25zLm1hcChmdW5jdGlvbiAocG9pbnQpIHsKICAgICAgICAgIHJldHVybiBbdGhhdC54U2NhbGUoY29udG91clhTY2FsZShwb2ludFswXSkpLAogICAgICAgICAgLy8gdGhhdC54U2NhbGUoY29udG91clhTY2FsZShwb2ludFswXSkpICsgKHRoYXQuc3ZnRnVsbFNpemUud2lkdGggLSB0aGF0LnN2Z0Z1bGxTaXplLmhlaWdodCkgLyAyLAogICAgICAgICAgdGhhdC55U2NhbGUoY29udG91cllTY2FsZShwb2ludFsxXSkpXTsKICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9KTsKICAgIHJldHVybiBpdGVtOwogIH0pOwoKICAvLyBDcmVhdGUgYSBuZXcgY29sb3IgaW50ZXJwb2xhdG9yCiAgLy8gKHN0YXJ0aW5nIGZyb20gd2hpdGUgaGVyZSkKICB2YXIgY29sb3JTY2FsZUludGVycG9sYXRvciA9IGQzLmludGVycG9sYXRlTGFiKCcjZmZmZmZmJywgY29uZmlnLmxheW91dFsnZ3JvdXBDb2xvcnMnXVsoKF90aGF0JGdyb3VwTmFtZXMgPSB0aGF0Lmdyb3VwTmFtZXMpID09PSBudWxsIHx8IF90aGF0JGdyb3VwTmFtZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF90aGF0JGdyb3VwTmFtZXMuaW5kZXhPZihncm91cCkpIHx8IDBdKTsKICB2YXIgY29sb3JTY2FsZSA9IGQzLnNjYWxlU2VxdWVudGlhbChkMy5leHRlbnQodGhyZXNob2xkcyksIGZ1bmN0aW9uIChkKSB7CiAgICByZXR1cm4gY29sb3JTY2FsZUludGVycG9sYXRvcihkIC8gMSk7CiAgfSk7CgogIC8vIERyYXcgdGhlIGNvbnRvdXJzCiAgY29udG91ckdyb3VwLnNlbGVjdEFsbCgncGF0aCcpLmRhdGEoY29udG91cnMuc2xpY2UoMSkpLmpvaW4oJ3BhdGgnKS5hdHRyKCdmaWxsJywgZnVuY3Rpb24gKGQpIHsKICAgIHJldHVybiBjb2xvclNjYWxlKGQudmFsdWUpOwogIH0pLmF0dHIoJ2QnLCBkMy5nZW9QYXRoKCkpOwogIHJldHVybiBjb250b3VyczsKfQo7CgovKioKICogQ29udmVydCB0aGUgY3VycmVudCB6b29tIHRyYW5zZm9ybSBpbnRvIGEgbWF0cml4CiAqIEBwYXJhbSB6b29tVHJhbnNmb3JtIEQzIHpvb20gdHJhbnNmb3JtCiAqIEByZXR1cm5zIDFEIG1hdHJpeAogKi8KdmFyIGdldFpvb21NYXRyaXggPSBmdW5jdGlvbiBnZXRab29tTWF0cml4KHpvb21UcmFuc2Zvcm0pIHsKICAvLyBUcmFuc2Zvcm1pbmcgdGhlIHN0YWdlIHNwYWNlIGJhc2VkIG9uIHRoZSBjdXJyZW50IHpvb20gdHJhbnNmb3JtCiAgdmFyIHpvb21NYXRyaXggPSBbW3pvb21UcmFuc2Zvcm0uaywgMCwgem9vbVRyYW5zZm9ybS54XSwgWzAsIHpvb21UcmFuc2Zvcm0uaywgem9vbVRyYW5zZm9ybS55XSwgWzAsIDAsIDFdXTsKICB2YXIgem9vbU1hdHJpeDFEID0gem9vbU1hdHJpeC5mbGF0KCk7CiAgcmV0dXJuIHpvb21NYXRyaXgxRDsKfTsKZXhwb3J0IGZ1bmN0aW9uIHVwZGF0ZVdlYkdMQnVmZmVycyh0aGF0LCBuZXdQb2ludHMpIHsKICAvLyBHZXQgdGhlIHBvc2l0aW9uIGFuZCBjb2xvciBvZiBlYWNoIG5ldyBwb2ludAogIHZhciBwb3NpdGlvbnMgPSBbXTsKICB2YXIgdGV4dHVyZUNvb3JkcyA9IFtdOwogIHZhciBfaXRlcmF0b3I2ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobmV3UG9pbnRzKSwKICAgIF9zdGVwNjsKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3I2LnMoKTsgIShfc3RlcDYgPSBfaXRlcmF0b3I2Lm4oKSkuZG9uZTspIHsKICAgICAgdmFyIHBvaW50ID0gX3N0ZXA2LnZhbHVlOwogICAgICBwb3NpdGlvbnMucHVzaChbcG9pbnQueCwgcG9pbnQueV0pOwogICAgICBpZiAodGhhdC50aW1lVGV4dHVyZU1hcCA9PT0gbnVsbCkgewogICAgICAgIGlmICh0aGF0Lmdyb3VwTmFtZXMgJiYgcG9pbnQuZ3JvdXBJRCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICB0ZXh0dXJlQ29vcmRzLnB1c2goW3BvaW50Lmdyb3VwSUQgLyB0aGF0Lmdyb3VwTmFtZXMubGVuZ3RoLCAwXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRleHR1cmVDb29yZHMucHVzaChbMCwgMF0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGhhdC50aW1lVGV4dHVyZU1hcC5oYXMocG9pbnQudGltZSkpIHsKICAgICAgICAgIHZhciB1ID0gdGhhdC50aW1lVGV4dHVyZU1hcC5nZXQocG9pbnQudGltZSkgLyAodGhhdC50aW1lVGV4dHVyZU1hcC5zaXplIC0gMSk7CiAgICAgICAgICB0ZXh0dXJlQ29vcmRzLnB1c2goW3UsIDAuNV0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyBUaGUgbGFzdCBlbnRyeSBpbiB0aGUgdGV4dHVyZSBhcnJheSBpcyByZXNlcnZlZCBmb3IgJ2JhZCcgcG9pbnRzCiAgICAgICAgICAvLyAoZS5nLiwgd3JvbmcgeWVhcikKICAgICAgICAgIHRleHR1cmVDb29yZHMucHVzaChbMSwgMF0pOwogICAgICAgIH0KICAgICAgfQogICAgfQoKICAgIC8vIFVwZGF0ZSB0aGUgYnVmZmVyIHVzaW5nIGJ5dGUgb2Zmc2V0cwogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yNi5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjYuZigpOwogIH0KICB0aGF0LmZyb250UG9zaXRpb25CdWZmZXIuc3ViZGF0YShwb3NpdGlvbnMsIHRoYXQuZnJvbnRCdWZmZXJQb2ludFNpemUgKiAyICogNCk7CiAgdGhhdC5mcm9udFRleHR1cmVDb29yZGluYXRlQnVmZmVyLnN1YmRhdGEodGV4dHVyZUNvb3JkcywgdGhhdC5mcm9udEJ1ZmZlclBvaW50U2l6ZSAqIDIgKiA0KTsKICB0aGF0LmZyb250QnVmZmVyUG9pbnRTaXplICs9IG5ld1BvaW50cy5sZW5ndGg7Cn0KZXhwb3J0IGZ1bmN0aW9uIGhpZ2hsaWdodFBvaW50KHRoYXQsIGFyZ3MpIHsKICB2YXIgb2ZmeCA9IDA7CiAgdmFyIHBvaW50ID0gYXJncy5wb2ludCwKICAgIGFuaW1hdGVkID0gYXJncy5hbmltYXRlZDsKICBpZiAoIWFueVRydWUodGhhdC5zaG93UG9pbnRzKSkgcmV0dXJuOwogIGlmIChwb2ludCA9PT0gdGhhdC5ob3ZlclBvaW50KSByZXR1cm47CiAgaWYgKHRoYXQuaGlkZUhpZ2hsaWdodHMpIHJldHVybjsKCiAgLy8gRHJhdyB0aGUgcG9pbnQgb24gdGhlIHRvcCBzdmcKICB2YXIgZ3JvdXAgPSB0aGF0LnRvcFN2Zy5zZWxlY3QoJ2cudG9wLWNvbnRlbnQgZy5oaWdobGlnaHRzJyk7CiAgdmFyIG9sZEhpZ2hsaWdodFBvaW50ID0gZ3JvdXAuc2VsZWN0KCdjaXJjbGUuaGlnaGxpZ2h0LXBvaW50Jyk7CgogIC8vIOaVtOS9k+WQkeWPs+i/m+ihjOWBj+enuyAKCiAgLy8gSG92ZXJpbmcgZW1wdHkgc3BhY2UKICBpZiAocG9pbnQgPT09IHVuZGVmaW5lZCkgewogICAgaWYgKHBvaW50TW91c2VsZWF2ZVRpbWVyICE9PSBudWxsKSB7CiAgICAgIGNsZWFyVGltZW91dChwb2ludE1vdXNlbGVhdmVUaW1lcik7CiAgICAgIHBvaW50TW91c2VsZWF2ZVRpbWVyID0gbnVsbDsKICAgIH0KICAgIGlmIChwb2ludE1vdXNlZW50ZXJUaW1lciAhPT0gbnVsbCkgewogICAgICBjbGVhclRpbWVvdXQocG9pbnRNb3VzZWVudGVyVGltZXIpOwogICAgICBwb2ludE1vdXNlZW50ZXJUaW1lciA9IG51bGw7CiAgICB9CgogICAgLy8gQ2xlYXIgdGhlIGhpZ2hsaWdodCBhbmQgdG9vbHRpcCBpbiBhIHNob3J0IGRlbGF5CiAgICBwb2ludE1vdXNlbGVhdmVUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICB0aGF0LmhvdmVyUG9pbnQgPSBudWxsOwogICAgICB0aGF0LnRvb2x0aXBUb3AuY2xhc3NMaXN0LmFkZCgnaGlkZGVuJyk7CiAgICAgIG9sZEhpZ2hsaWdodFBvaW50LnJlbW92ZSgpOwogICAgICBwb2ludE1vdXNlbGVhdmVUaW1lciA9IG51bGw7CiAgICB9LCA1MCk7CiAgICByZXR1cm47CiAgfQoKICAvLyBIb3ZlcmluZyBvdmVyIGEgcG9pbnQKICB0aGF0LmhvdmVyUG9pbnQgPSBwb2ludDsKICBpZiAodGhhdC4kc3RvcmUuc3RhdGUuZGF0YXNldE5hbWUgPT0gIkltYWdlTmV0MjAxMlZhbFNldCIpIHsKICAgIHRoYXQuaG92ZXJQb2ludC5ncm91cElEID0gMDsKICB9CgogIC8vIHRoYXQuaG92ZXJQb2ludC5ncm91cElEID0gMDsKICAvLyBDaGFuZ2UgdGhlIHBvaW50J3MgdGV4dCB0byBhbiBpbWFnZSB0YWcgaWYgdGhpcyBpcyBhbiBpbWFnZSBwb2ludAoKICBpZiAodGhhdC5ncmlkRGF0YSAmJiB0aGF0LmdyaWREYXRhLmltYWdlICE9PSB1bmRlZmluZWQpIHsKICAgIGlmICh0aGF0LmdyaWREYXRhLmltYWdlLmltYWdlR3JvdXAgPT09IHRoYXQuaG92ZXJQb2ludC5ncm91cElEKSB7CiAgICAgIGNvbnNvbGUubG9nKCJ0aGF0LmhvdmVyUG9pbnQiLCB0aGF0LmhvdmVyUG9pbnQsIHRoYXQuaG92ZXJQb2ludC5wcm9tcHQpOwogICAgICB0aGF0LmhvdmVyUG9pbnQucHJvbXB0ID0gIjxpbWcgY2xhc3M9XCJ0b29sdGlwLWltYWdlXCIgc3JjPVwiIi5jb25jYXQodGhhdC5ncmlkRGF0YS5pbWFnZS5pbWFnZVVSTFByZWZpeCArIHRoYXQuaG92ZXJQb2ludC5wcm9tcHQsICJcIj4iKTsKICAgIH0KICB9CiAgaWYgKHBvaW50TW91c2VsZWF2ZVRpbWVyICE9PSBudWxsKSB7CiAgICBjbGVhclRpbWVvdXQocG9pbnRNb3VzZWxlYXZlVGltZXIpOwogICAgcG9pbnRNb3VzZWxlYXZlVGltZXIgPSBudWxsOwogIH0KICB2YXIgaGlnaGxpZ2h0UmFkaXVzID0gTWF0aC5tYXgoMTAgLyB0aGF0LmN1clpvb21UcmFuc2Zvcm0uaywgdGhhdC5jdXJQb2ludFdpZHRoICogTWF0aC5leHAoTWF0aC5sb2codGhhdC5jdXJab29tVHJhbnNmb3JtLmspICogMC41NSkgLyB0aGF0LmN1clpvb21UcmFuc2Zvcm0uayk7CiAgdmFyIGhpZ2hsaWdodFN0cm9rZSA9IDEuMiAvIHRoYXQuY3VyWm9vbVRyYW5zZm9ybS5rOwogIHZhciBjdXJIaWdobGlnaHRQb2ludDsgLy8g55So5LqO5a2Y5YKo5b2T5YmN6auY5Lqu54K555qE6YCJ5oup5ZmoCgogIC8vIOWmguaenOayoeaciemrmOS6rueCuQogIGlmIChvbGRIaWdobGlnaHRQb2ludC5lbXB0eSgpKSB7CiAgICBjdXJIaWdobGlnaHRQb2ludCA9IGdyb3VwLmFwcGVuZCgnY2lyY2xlJykuYXR0cignY2xhc3MnLCAnaGlnaGxpZ2h0LXBvaW50JykuYXR0cignY3gnLCB0aGF0LnhTY2FsZShwb2ludC54KSArIG9mZngpLmF0dHIoJ2N5JywgdGhhdC55U2NhbGUocG9pbnQueSkpLmF0dHIoJ3InLCBoaWdobGlnaHRSYWRpdXMpLnN0eWxlKCdzdHJva2Utd2lkdGgnLCBoaWdobGlnaHRTdHJva2UpOwogIH0gZWxzZSB7CiAgICAvLyDlpoLmnpzlt7LmnInpq5jkuq7ngrkKICAgIGN1ckhpZ2hsaWdodFBvaW50ID0gb2xkSGlnaGxpZ2h0UG9pbnQ7CiAgICBpZiAoYW5pbWF0ZWQpIHsKICAgICAgY3VySGlnaGxpZ2h0UG9pbnQudHJhbnNpdGlvbigpLmR1cmF0aW9uKDE1MCkuYXR0cignY3gnLCB0aGF0LnhTY2FsZShwb2ludC54KSArIG9mZngpLmF0dHIoJ2N5JywgdGhhdC55U2NhbGUocG9pbnQueSkpLmF0dHIoJ3InLCBoaWdobGlnaHRSYWRpdXMpLnN0eWxlKCdzdHJva2Utd2lkdGgnLCBoaWdobGlnaHRTdHJva2UpLm9uKCdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgdXBkYXRlUG9wcGVyVG9vbHRpcCh0aGF0LnRvb2x0aXBUb3AsIGN1ckhpZ2hsaWdodFBvaW50Lm5vZGUoKSwgcG9pbnQucHJvbXB0LCAndG9wJyk7CiAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgY3VySGlnaGxpZ2h0UG9pbnQuYXR0cignY3gnLCB0aGF0LnhTY2FsZShwb2ludC54KSArIG9mZngpLmF0dHIoJ2N5JywgdGhhdC55U2NhbGUocG9pbnQueSkpLmF0dHIoJ3InLCBoaWdobGlnaHRSYWRpdXMpLnN0eWxlKCdzdHJva2Utd2lkdGgnLCBoaWdobGlnaHRTdHJva2UpOwogICAgICB1cGRhdGVQb3BwZXJUb29sdGlwKHRoYXQudG9vbHRpcFRvcCwgY3VySGlnaGxpZ2h0UG9pbnQubm9kZSgpLCBwb2ludC5wcm9tcHQsICd0b3AnKTsKICAgIH0KICB9CiAgaWYgKHBvaW50TW91c2VlbnRlclRpbWVyICE9PSBudWxsKSB7CiAgICBjbGVhclRpbWVvdXQocG9pbnRNb3VzZWVudGVyVGltZXIpOwogIH0KICBwb2ludE1vdXNlZW50ZXJUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgdGhhdC50b29sdGlwVG9wLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZGRlbicpOwogICAgcG9pbnRNb3VzZWVudGVyVGltZXIgPSBudWxsOwogIH0sIDMwMCk7Cn0KZnVuY3Rpb24gZ2V0Q29vcmRpbmF0ZXMobm9kZXNJZExpc3QsIHByb21wdFBvaW50cykgewogIHZhciBjb29yZGluYXRlcyA9IFtdOwogIHZhciBfaXRlcmF0b3I3ID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobm9kZXNJZExpc3QpLAogICAgX3N0ZXA3OwogIHRyeSB7CiAgICBmb3IgKF9pdGVyYXRvcjcucygpOyAhKF9zdGVwNyA9IF9pdGVyYXRvcjcubigpKS5kb25lOykgewogICAgICB2YXIgcmVzdWx0SW5kZXggPSBfc3RlcDcudmFsdWU7CiAgICAgIHZhciBjdXJQb2ludCA9IHByb21wdFBvaW50c1tyZXN1bHRJbmRleF07CiAgICAgIGNvb3JkaW5hdGVzLnB1c2goY3VyUG9pbnQpOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yNy5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjcuZigpOwogIH0KICByZXR1cm4gY29vcmRpbmF0ZXM7Cn0KZXhwb3J0IGZ1bmN0aW9uIGRyYXdTZWFyY2hTY2F0dGVyUGxvdCh0aGF0KSB7CiAgaWYgKCF0aGF0LndlYkdMTWF0cmljZXMpIHsKICAgIHRocm93IG5ldyBFcnJvcignd2ViR0xNYXRyaWNlcyBub3QgaW5pdGlhbGl6ZWQnKTsKICB9CiAgaWYgKHRoYXQuJHN0b3JlLnN0YXRlLmRhdGFOb2RlTGluay5saW5rcyA9PSBudWxsKSB7CiAgICByZXR1cm4gbnVsbDsKICB9CiAgdGhhdC5zZWFyY2hQb2ludFJlZ2wuY2xlYXIoewogICAgY29sb3I6IFswLCAwLCAwLCAwXSwKICAgIGRlcHRoOiAxCiAgfSk7CgogIC8vIEhlcmUgYXJlIHNvbWUgY29kZSBmb3IgcHJvY2Vzc2luZyBkYXRhCiAgdmFyIGNvbm5lY3REYXRhID0gdGhhdC4kc3RvcmUuc3RhdGUuZGF0YU5vZGVMaW5rLmxpbmtzOwogIHZhciBub2RlTGlzdCA9IHRoYXQuJHN0b3JlLnN0YXRlLmRhdGFOb2RlTGluay5ub2RlczsKICB2YXIgc3RhcnROb2RlID0gdGhhdC4kc3RvcmUuc3RhdGUuZGF0YU5vZGVMaW5rLnN0YXJ0Tm9kZTsKICB2YXIgc2VhcmNoTGlzdCA9IHRoYXQuJHN0b3JlLnN0YXRlLmRhdGFOb2RlTGluay5zTGlzdDsKICB2YXIgZ3JvdW5kVHJ1dGhMaXN0ID0gdGhhdC4kc3RvcmUuc3RhdGUuZGF0YU5vZGVMaW5rLmdMaXN0OwogIHZhciBkaWZmU0xpc3QgPSBzZWFyY2hMaXN0LmZpbHRlcihmdW5jdGlvbiAoeCkgewogICAgcmV0dXJuICFncm91bmRUcnV0aExpc3QuaW5jbHVkZXMoeCk7CiAgfSk7CiAgdmFyIGRpZmZHTGlzdCA9IGdyb3VuZFRydXRoTGlzdC5maWx0ZXIoZnVuY3Rpb24gKHgpIHsKICAgIHJldHVybiAhc2VhcmNoTGlzdC5pbmNsdWRlcyh4KTsKICB9KTsKICB2YXIgaW50ZXJMaXN0ID0gc2VhcmNoTGlzdC5maWx0ZXIoZnVuY3Rpb24gKHgpIHsKICAgIHJldHVybiBncm91bmRUcnV0aExpc3QuaW5jbHVkZXMoeCk7CiAgfSk7CiAgdmFyIHRyYWNlUG9pbnRzID0gW107CiAgdmFyIF9pdGVyYXRvcjggPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihub2RlTGlzdCksCiAgICBfc3RlcDg7CiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yOC5zKCk7ICEoX3N0ZXA4ID0gX2l0ZXJhdG9yOC5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciByZXN1bHRJbmRleCA9IF9zdGVwOC52YWx1ZTsKICAgICAgdmFyIGN1clBvaW50ID0gdGhhdC5wcm9tcHRQb2ludHNbcmVzdWx0SW5kZXguaWRdOwogICAgICB0cmFjZVBvaW50cy5wdXNoKGN1clBvaW50KTsKICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvcjguZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3I4LmYoKTsKICB9CiAgdmFyIGVkZ2VQb3NpdGlvbnMgPSBbXTsKICB2YXIgX2l0ZXJhdG9yOSA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGNvbm5lY3REYXRhKSwKICAgIF9zdGVwOTsKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3I5LnMoKTsgIShfc3RlcDkgPSBfaXRlcmF0b3I5Lm4oKSkuZG9uZTspIHsKICAgICAgdmFyIGxpbmsgPSBfc3RlcDkudmFsdWU7CiAgICAgIHZhciBzdGFydFBvaW50ID0gdGhhdC5wcm9tcHRQb2ludHNbbGluay5zb3VyY2VdOwogICAgICB2YXIgZW5kUG9pbnQgPSB0aGF0LnByb21wdFBvaW50c1tsaW5rLnRhcmdldF07CgogICAgICAvLyDmt7vliqDovrnnmoTotbfngrnlkoznu4jngrkKICAgICAgaWYgKHN0YXJ0UG9pbnQgJiYgZW5kUG9pbnQpIHsKICAgICAgICBlZGdlUG9zaXRpb25zLnB1c2goc3RhcnRQb2ludC54LCBzdGFydFBvaW50LnksIGVuZFBvaW50LngsIGVuZFBvaW50LnkpOwogICAgICB9CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3I5LmUoZXJyKTsKICB9IGZpbmFsbHkgewogICAgX2l0ZXJhdG9yOS5mKCk7CiAgfQogIGRpZmZHTGlzdCA9IGdldENvb3JkaW5hdGVzKGRpZmZHTGlzdCwgdGhhdC5wcm9tcHRQb2ludHMpOwogIGRpZmZTTGlzdCA9IGdldENvb3JkaW5hdGVzKGRpZmZTTGlzdCwgdGhhdC5wcm9tcHRQb2ludHMpOwogIGludGVyTGlzdCA9IGdldENvb3JkaW5hdGVzKGludGVyTGlzdCwgdGhhdC5wcm9tcHRQb2ludHMpOwogIHN0YXJ0Tm9kZSA9IGdldENvb3JkaW5hdGVzKFtzdGFydE5vZGVdLCB0aGF0LnByb21wdFBvaW50cyk7CiAgdmFyIGN1ckxpbmVXaWR0aCA9IDIuMDsgLy8g6K6+572u57q/5p2h5a695bqmCiAgdmFyIGxpbmVDb3VudCA9IGVkZ2VQb3NpdGlvbnMubGVuZ3RoIC8gNDsgLy8g5q+P5Lik5Liq6aG254K56KGo56S65LiA5p2h57q/CiAgLy8gY3VyUG9pbnRXaWR0aCA9IE1hdGgubWluKDUsIGN1clBvaW50V2lkdGgpOwogIHZhciBsaW5lQWxwaGEgPSAxIC8gKE1hdGgubG9nKGxpbmVDb3VudCkgLyBNYXRoLmxvZyg1MDApKTsKCiAgLy8gLy8gR2V0IHRoZSBjdXJyZW50IHpvb20KICB2YXIgem9vbU1hdHJpeCA9IGdldFpvb21NYXRyaXgodGhhdC5jdXJab29tVHJhbnNmb3JtKTsKCiAgLy8gQ3JlYXRlIGEgdGV4dHVyZSBhcnJheSAoZGVmYXVsdCAzeDEpCiAgdmFyIHRleHR1cmVBcnJheSA9IFsKICAvLyB0aW1lUG9pbnRDb2xvckludCAoUkdCQSkKICBjb25maWcubGF5b3V0LnRpbWVQb2ludENvbG9ySW50WzBdLAogIC8vIFIKICBjb25maWcubGF5b3V0LnRpbWVQb2ludENvbG9ySW50WzFdLAogIC8vIEcKICBjb25maWcubGF5b3V0LnRpbWVQb2ludENvbG9ySW50WzJdLAogIC8vIEIKICAyNTUsCiAgLy8gQQoKICAvLyBBZGQgeWVsbG93IGNvbG9yIChSR0JBKQogIDI1NSwKICAvLyBSCiAgMjU1LAogIC8vIEcKICAwLAogIC8vIEIKICAyNTUsCiAgLy8gQQoKICAvLyBBZGQgYmx1ZSBjb2xvciAoUkdCQSkKICAwLAogIC8vIFIKICAwLAogIC8vIEcKICAyNTUsCiAgLy8gQgogIDI1NSwKICAvLyBBCgogIC8vIEFkZCBncmVlbiBjb2xvciAoUkdCQSkKICAwLAogIC8vIFIKICAyNTUsCiAgLy8gRwogIDAsCiAgLy8gQgogIDI1NSwKICAvLyBBCgogIC8vIHNlY29uZFBvaW50Q29sb3JJbnQgKFJHQkEpCiAgY29uZmlnLmxheW91dC5zZWNvbmRQb2ludENvbG9ySW50WzBdLAogIC8vIFIKICBjb25maWcubGF5b3V0LnNlY29uZFBvaW50Q29sb3JJbnRbMV0sCiAgLy8gRwogIGNvbmZpZy5sYXlvdXQuc2Vjb25kUG9pbnRDb2xvckludFsyXSwKICAvLyBCCiAgMjU1IC8vIEEKICBdOwoKICAvLyBDcmVhdGUgdGV4dHVyZSB3aXRoIHdpZHRoIDUgYW5kIGhlaWdodCAxIChub3cgNSBjb2xvcnMpCiAgdmFyIHRleHR1cmUgPSB0aGF0LnNlYXJjaFBvaW50UmVnbC50ZXh0dXJlKHsKICAgIHdpZHRoOiA1LAogICAgaGVpZ2h0OiAxLAogICAgZGF0YTogdGV4dHVyZUFycmF5LAogICAgZm9ybWF0OiAncmdiYScKICB9KTsKICB2YXIgbGluZVV2cyA9IFtdOwogIGZvciAodmFyIGkgPSAwOyBpIDwgZWRnZVBvc2l0aW9ucyAvIDI7IGkrKykgewogICAgbGluZVV2cy5wdXNoKFswLCAwXSk7CiAgfQogIHZhciBkcmF3TGluZXMgPSB0aGF0LnNlYXJjaFBvaW50UmVnbCh7CiAgICBkZXB0aDogewogICAgICBlbmFibGU6IGZhbHNlCiAgICB9LAogICAgc3RlbmNpbDogewogICAgICBlbmFibGU6IGZhbHNlCiAgICB9LAogICAgZnJhZzogZWRnZUZyYWdtZW50U2hhZGVyLAogICAgdmVydDogZWRnZVZlcnRleFNoYWRlciwKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcG9zaXRpb246IGVkZ2VQb3NpdGlvbnMsCiAgICAgIHRleHR1cmVDb29yZDogbGluZVV2cwogICAgfSwKICAgIHVuaWZvcm1zOiB7CiAgICAgIGRhdGFTY2FsZU1hdHJpeDogdGhhdC53ZWJHTE1hdHJpY2VzLmRhdGFTY2FsZU1hdHJpeCwKICAgICAgem9vbU1hdHJpeDogem9vbU1hdHJpeCwKICAgICAgbm9ybWFsaXplTWF0cml4OiB0aGF0LndlYkdMTWF0cmljZXMubm9ybWFsaXplTWF0cml4LAogICAgICBMaW5lV2lkdGg6IGN1ckxpbmVXaWR0aCwKICAgICAgYWxwaGE6IGxpbmVBbHBoYSwKICAgICAgdXNlckFscGhhOiAtMSwKICAgICAgdGV4dHVyZTogdGV4dHVyZQogICAgfSwKICAgIGJsZW5kOiB7CiAgICAgIGVuYWJsZTogdHJ1ZSwKICAgICAgZnVuYzogewogICAgICAgIHNyY1JHQjogJ29uZScsCiAgICAgICAgc3JjQWxwaGE6ICdvbmUnLAogICAgICAgIGRzdFJHQjogJ29uZSBtaW51cyBzcmMgYWxwaGEnLAogICAgICAgIGRzdEFscGhhOiAnb25lIG1pbnVzIHNyYyBhbHBoYScKICAgICAgfQogICAgfSwKICAgIGNvdW50OiBsaW5lQ291bnQgKiAyLAogICAgcHJpbWl0aXZlOiAnbGluZXMnCiAgfSk7CiAgZHJhd0xpbmVzKCk7CgogIC8vIENvbGxlY3QgcG9zaXRpb24gYW5kIGNvbG9yIGZvciBlYWNoIHBvaW50CiAgdmFyIGFsbHBvaW50UG9zaXRpb25zID0gW107CiAgdmFyIGFsbHBvaW50VXZzID0gW107CiAgZm9yICh2YXIgX2kgPSAwLCBfdHJhY2VQb2ludHMgPSB0cmFjZVBvaW50czsgX2kgPCBfdHJhY2VQb2ludHMubGVuZ3RoOyBfaSsrKSB7CiAgICB2YXIgcG9pbnQgPSBfdHJhY2VQb2ludHNbX2ldOwogICAgYWxscG9pbnRQb3NpdGlvbnMucHVzaChbcG9pbnQueCwgcG9pbnQueV0pOwogICAgYWxscG9pbnRVdnMucHVzaChbMC4xLCAwLjFdKTsKICB9CiAgLy8gQWRqdXN0IHBvaW50IHdpZHRoIGJhc2VkIG9uIHRoZSBudW1iZXIgb2YgcG9pbnRzIHRvIGRyYXcKICB2YXIgYWxscG9pbnRDb3VudCA9IGFsbHBvaW50UG9zaXRpb25zLmxlbmd0aDsKCiAgLy8gTG9nYXJpdGhtaWMgcmVncmVzc2lvbiBieSBmaXR0aW5nIHRoZSBmb2xsb3dpbmcgdGhyZWUgcG9pbnRzCiAgLy8gaHR0cHM6Ly9rZWlzYW4uY2FzaW8uY29tL2V4ZWMvc3lzdGVtLzE0MDU5OTMwMjI2NjkxCiAgLy8gWyg2ZTQsIDIpLCAoM2U1LCAxKSwgWzEuOGU2LCAwLjVdXQogIHZhciBhID0gNi43MTY4MjA3MTsKICB2YXIgYiA9IC0wLjQzNzk3NDg3MTsKICB2YXIgY3VyUG9pbnRXaWR0aCA9IGEgKyBiICogTWF0aC5sb2coY29uZmlnLmxheW91dC5zY2F0dGVyRG90UmFkaXVzICogKHRoYXQuc3ZnRnVsbFNpemUuaGVpZ2h0IC8gNzYwKSAqIGFsbHBvaW50Q291bnQpOwogIHZhciBwb2ludEFscGhhID0gMSAvIChNYXRoLmxvZyhhbGxwb2ludENvdW50KSAvIE1hdGgubG9nKDUwMCkpOwogIHZhciBkcmF3QWxsUG9pbnRzID0gdGhhdC5zZWFyY2hQb2ludFJlZ2woewogICAgZGVwdGg6IHsKICAgICAgZW5hYmxlOiBmYWxzZQogICAgfSwKICAgIC8vIOemgeeUqOa3seW6pua1i+ivlQogICAgc3RlbmNpbDogewogICAgICBlbmFibGU6IGZhbHNlCiAgICB9LAogICAgLy8g56aB55So5qih5p2/57yT5Yay5Yy6CiAgICBmcmFnOiBmcmFnbWVudFNoYWRlciwKICAgIC8vIOeJh+auteedgOiJsuWZqAogICAgdmVydDogdmVydGV4U2hhZGVyLAogICAgLy8g6aG254K5552A6Imy5ZmoCgogICAgYXR0cmlidXRlczogewogICAgICBwb3NpdGlvbjogYWxscG9pbnRQb3NpdGlvbnMsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCBwb3NpdGlvbnMKICAgICAgdGV4dHVyZUNvb3JkOiBhbGxwb2ludFV2cyAvLyDliqjmgIHkvKDlhaXnmoQgdXZzCiAgICB9LAogICAgdW5pZm9ybXM6IHsKICAgICAgcG9pbnRXaWR0aDogY3VyUG9pbnRXaWR0aCwKICAgICAgZGF0YVNjYWxlTWF0cml4OiB0aGF0LndlYkdMTWF0cmljZXMuZGF0YVNjYWxlTWF0cml4LAogICAgICB6b29tTWF0cml4OiB6b29tTWF0cml4LAogICAgICAvLyDliqjmgIHkvKDlhaXnmoQgem9vbU1hdHJpeAogICAgICBub3JtYWxpemVNYXRyaXg6IHRoYXQud2ViR0xNYXRyaWNlcy5ub3JtYWxpemVNYXRyaXgsCiAgICAgIGFscGhhOiBwb2ludEFscGhhLAogICAgICAvLyDpgI/mmI7luqYKICAgICAgdXNlckFscGhhOiAtMSwKICAgICAgLy8g55So5oi36Ieq5a6a5LmJ6YCP5piO5bqmCiAgICAgIHRleHR1cmU6IHRleHR1cmUgLy8g5Lyg6YCS57q555CG5pWw5o2uCiAgICB9LAogICAgYmxlbmQ6IHsKICAgICAgZW5hYmxlOiB0cnVlLAogICAgICAvLyDlkK/nlKjmt7flkIgKICAgICAgZnVuYzogewogICAgICAgIHNyY1JHQjogJ29uZScsCiAgICAgICAgLy8gUkdC5rqQ5re35ZCI5Zug5a2QCiAgICAgICAgc3JjQWxwaGE6ICdvbmUnLAogICAgICAgIC8vIEFscGhh5rqQ5re35ZCI5Zug5a2QCiAgICAgICAgZHN0UkdCOiAnb25lIG1pbnVzIHNyYyBhbHBoYScsCiAgICAgICAgLy8gUkdC55uu5qCH5re35ZCI5Zug5a2QCiAgICAgICAgZHN0QWxwaGE6ICdvbmUgbWludXMgc3JjIGFscGhhJyAvLyBBbHBoYeebruagh+a3t+WQiOWboOWtkAogICAgICB9CiAgICB9LAogICAgY291bnQ6IGFsbHBvaW50Q291bnQsCiAgICAvLyDliqjmgIHkvKDlhaXnmoTngrnmlbAKICAgIHByaW1pdGl2ZTogJ3BvaW50cycgLy8g57uY5Yi254K5CiAgfSk7CiAgZHJhd0FsbFBvaW50cygpOwoKICAvLyBDb2xsZWN0IHBvc2l0aW9uIGFuZCBjb2xvciBmb3IgZWFjaCBwb2ludAogIHZhciBpbnRlclBvc2l0aW9ucyA9IFtdOwogIHZhciBpbnRlclBvaW50VXZzID0gW107CiAgdmFyIF9pdGVyYXRvcjEwID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoaW50ZXJMaXN0KSwKICAgIF9zdGVwMTA7CiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yMTAucygpOyAhKF9zdGVwMTAgPSBfaXRlcmF0b3IxMC5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBfcG9pbnQgPSBfc3RlcDEwLnZhbHVlOwogICAgICBpbnRlclBvc2l0aW9ucy5wdXNoKFtfcG9pbnQueCwgX3BvaW50LnldKTsKICAgICAgaW50ZXJQb2ludFV2cy5wdXNoKFsxLjAsIDEuMF0pOwogICAgfQoKICAgIC8vIEFkanVzdCBwb2ludCB3aWR0aCBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHBvaW50cyB0byBkcmF3CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3IxMC5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjEwLmYoKTsKICB9CiAgdmFyIGludGVyUG9pbnRDb3VudCA9IGludGVyUG9zaXRpb25zLmxlbmd0aDsKICB2YXIgZHJhd0ludGVyUG9pbnRzID0gdGhhdC5zZWFyY2hQb2ludFJlZ2woewogICAgZGVwdGg6IHsKICAgICAgZW5hYmxlOiBmYWxzZQogICAgfSwKICAgIC8vIOemgeeUqOa3seW6pua1i+ivlQogICAgc3RlbmNpbDogewogICAgICBlbmFibGU6IGZhbHNlCiAgICB9LAogICAgLy8g56aB55So5qih5p2/57yT5Yay5Yy6CiAgICBmcmFnOiBmcmFnbWVudFNoYWRlciwKICAgIC8vIOeJh+auteedgOiJsuWZqAogICAgdmVydDogdmVydGV4U2hhZGVyLAogICAgLy8g6aG254K5552A6Imy5ZmoCgogICAgYXR0cmlidXRlczogewogICAgICBwb3NpdGlvbjogaW50ZXJQb3NpdGlvbnMsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCBwb3NpdGlvbnMKICAgICAgdGV4dHVyZUNvb3JkOiBpbnRlclBvaW50VXZzIC8vIOWKqOaAgeS8oOWFpeeahCB1dnMKICAgIH0sCiAgICB1bmlmb3JtczogewogICAgICBwb2ludFdpZHRoOiBjdXJQb2ludFdpZHRoLAogICAgICBkYXRhU2NhbGVNYXRyaXg6IHRoYXQud2ViR0xNYXRyaWNlcy5kYXRhU2NhbGVNYXRyaXgsCiAgICAgIHpvb21NYXRyaXg6IHpvb21NYXRyaXgsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCB6b29tTWF0cml4CiAgICAgIG5vcm1hbGl6ZU1hdHJpeDogdGhhdC53ZWJHTE1hdHJpY2VzLm5vcm1hbGl6ZU1hdHJpeCwKICAgICAgYWxwaGE6IHBvaW50QWxwaGEsCiAgICAgIC8vIOmAj+aYjuW6pgogICAgICB1c2VyQWxwaGE6IC0xLAogICAgICAvLyDnlKjmiLfoh6rlrprkuYnpgI/mmI7luqYKICAgICAgdGV4dHVyZTogdGV4dHVyZSAvLyDkvKDpgJLnurnnkIbmlbDmja4KICAgIH0sCiAgICBibGVuZDogewogICAgICBlbmFibGU6IHRydWUsCiAgICAgIC8vIOWQr+eUqOa3t+WQiAogICAgICBmdW5jOiB7CiAgICAgICAgc3JjUkdCOiAnb25lJywKICAgICAgICAvLyBSR0LmupDmt7flkIjlm6DlrZAKICAgICAgICBzcmNBbHBoYTogJ29uZScsCiAgICAgICAgLy8gQWxwaGHmupDmt7flkIjlm6DlrZAKICAgICAgICBkc3RSR0I6ICdvbmUgbWludXMgc3JjIGFscGhhJywKICAgICAgICAvLyBSR0Lnm67moIfmt7flkIjlm6DlrZAKICAgICAgICBkc3RBbHBoYTogJ29uZSBtaW51cyBzcmMgYWxwaGEnIC8vIEFscGhh55uu5qCH5re35ZCI5Zug5a2QCiAgICAgIH0KICAgIH0sCiAgICBjb3VudDogaW50ZXJQb2ludENvdW50LAogICAgLy8g5Yqo5oCB5Lyg5YWl55qE54K55pWwCiAgICBwcmltaXRpdmU6ICdwb2ludHMnIC8vIOe7mOWItueCuQogIH0pOwogIGlmIChpbnRlckxpc3QubGVuZ3RoID4gMCkgewogICAgZHJhd0ludGVyUG9pbnRzKCk7CiAgfQoKICAvLyBDb2xsZWN0IHBvc2l0aW9uIGFuZCBjb2xvciBmb3IgZWFjaCBwb2ludAogIHZhciBkaWZmR1Bvc2l0aW9ucyA9IFtdOwogIHZhciBkaWZmR1BvaW50VXZzID0gW107CiAgdmFyIF9pdGVyYXRvcjExID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZGlmZkdMaXN0KSwKICAgIF9zdGVwMTE7CiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yMTEucygpOyAhKF9zdGVwMTEgPSBfaXRlcmF0b3IxMS5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBfcG9pbnQyID0gX3N0ZXAxMS52YWx1ZTsKICAgICAgZGlmZkdQb3NpdGlvbnMucHVzaChbX3BvaW50Mi54LCBfcG9pbnQyLnldKTsKICAgICAgZGlmZkdQb2ludFV2cy5wdXNoKFswLjMsIDAuM10pOwogICAgfQoKICAgIC8vIEFkanVzdCBwb2ludCB3aWR0aCBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHBvaW50cyB0byBkcmF3CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3IxMS5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjExLmYoKTsKICB9CiAgdmFyIGRpZmZHUG9pbnRDb3VudCA9IGRpZmZHUG9zaXRpb25zLmxlbmd0aDsKICB2YXIgZHJhd0RpZmZHUG9pbnRzID0gdGhhdC5zZWFyY2hQb2ludFJlZ2woewogICAgZGVwdGg6IHsKICAgICAgZW5hYmxlOiBmYWxzZQogICAgfSwKICAgIC8vIOemgeeUqOa3seW6pua1i+ivlQogICAgc3RlbmNpbDogewogICAgICBlbmFibGU6IGZhbHNlCiAgICB9LAogICAgLy8g56aB55So5qih5p2/57yT5Yay5Yy6CiAgICBmcmFnOiBmcmFnbWVudFNoYWRlciwKICAgIC8vIOeJh+auteedgOiJsuWZqAogICAgdmVydDogdmVydGV4U2hhZGVyLAogICAgLy8g6aG254K5552A6Imy5ZmoCgogICAgYXR0cmlidXRlczogewogICAgICBwb3NpdGlvbjogZGlmZkdQb3NpdGlvbnMsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCBwb3NpdGlvbnMKICAgICAgdGV4dHVyZUNvb3JkOiBkaWZmR1BvaW50VXZzIC8vIOWKqOaAgeS8oOWFpeeahCB1dnMKICAgIH0sCiAgICB1bmlmb3JtczogewogICAgICBwb2ludFdpZHRoOiBjdXJQb2ludFdpZHRoLAogICAgICBkYXRhU2NhbGVNYXRyaXg6IHRoYXQud2ViR0xNYXRyaWNlcy5kYXRhU2NhbGVNYXRyaXgsCiAgICAgIHpvb21NYXRyaXg6IHpvb21NYXRyaXgsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCB6b29tTWF0cml4CiAgICAgIG5vcm1hbGl6ZU1hdHJpeDogdGhhdC53ZWJHTE1hdHJpY2VzLm5vcm1hbGl6ZU1hdHJpeCwKICAgICAgYWxwaGE6IHBvaW50QWxwaGEsCiAgICAgIC8vIOmAj+aYjuW6pgogICAgICB1c2VyQWxwaGE6IC0xLAogICAgICAvLyDnlKjmiLfoh6rlrprkuYnpgI/mmI7luqYKICAgICAgdGV4dHVyZTogdGV4dHVyZSAvLyDkvKDpgJLnurnnkIbmlbDmja4KICAgIH0sCiAgICBibGVuZDogewogICAgICBlbmFibGU6IHRydWUsCiAgICAgIC8vIOWQr+eUqOa3t+WQiAogICAgICBmdW5jOiB7CiAgICAgICAgc3JjUkdCOiAnb25lJywKICAgICAgICAvLyBSR0LmupDmt7flkIjlm6DlrZAKICAgICAgICBzcmNBbHBoYTogJ29uZScsCiAgICAgICAgLy8gQWxwaGHmupDmt7flkIjlm6DlrZAKICAgICAgICBkc3RSR0I6ICdvbmUgbWludXMgc3JjIGFscGhhJywKICAgICAgICAvLyBSR0Lnm67moIfmt7flkIjlm6DlrZAKICAgICAgICBkc3RBbHBoYTogJ29uZSBtaW51cyBzcmMgYWxwaGEnIC8vIEFscGhh55uu5qCH5re35ZCI5Zug5a2QCiAgICAgIH0KICAgIH0sCiAgICBjb3VudDogZGlmZkdQb2ludENvdW50LAogICAgLy8g5Yqo5oCB5Lyg5YWl55qE54K55pWwCiAgICBwcmltaXRpdmU6ICdwb2ludHMnIC8vIOe7mOWItueCuQogIH0pOwogIGlmIChkaWZmR0xpc3QubGVuZ3RoID4gMCkgewogICAgZHJhd0RpZmZHUG9pbnRzKCk7CiAgfQoKICAvLyBDb2xsZWN0IHBvc2l0aW9uIGFuZCBjb2xvciBmb3IgZWFjaCBwb2ludAogIHZhciBkaWZmU1Bvc2l0aW9ucyA9IFtdOwogIHZhciBkaWZmU1BvaW50VXZzID0gW107CiAgdmFyIF9pdGVyYXRvcjEyID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIoZGlmZlNMaXN0KSwKICAgIF9zdGVwMTI7CiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yMTIucygpOyAhKF9zdGVwMTIgPSBfaXRlcmF0b3IxMi5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBfcG9pbnQzID0gX3N0ZXAxMi52YWx1ZTsKICAgICAgZGlmZlNQb3NpdGlvbnMucHVzaChbX3BvaW50My54LCBfcG9pbnQzLnldKTsKICAgICAgZGlmZlNQb2ludFV2cy5wdXNoKFswLjgsIDAuOF0pOwogICAgfQoKICAgIC8vIEFkanVzdCBwb2ludCB3aWR0aCBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHBvaW50cyB0byBkcmF3CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3IxMi5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjEyLmYoKTsKICB9CiAgdmFyIGRpZmZTUG9pbnRDb3VudCA9IGRpZmZTUG9zaXRpb25zLmxlbmd0aDsKICB2YXIgZHJhd0RpZmZTUG9pbnRzID0gdGhhdC5zZWFyY2hQb2ludFJlZ2woewogICAgZGVwdGg6IHsKICAgICAgZW5hYmxlOiBmYWxzZQogICAgfSwKICAgIC8vIOemgeeUqOa3seW6pua1i+ivlQogICAgc3RlbmNpbDogewogICAgICBlbmFibGU6IGZhbHNlCiAgICB9LAogICAgLy8g56aB55So5qih5p2/57yT5Yay5Yy6CiAgICBmcmFnOiBmcmFnbWVudFNoYWRlciwKICAgIC8vIOeJh+auteedgOiJsuWZqAogICAgdmVydDogdmVydGV4U2hhZGVyLAogICAgLy8g6aG254K5552A6Imy5ZmoCgogICAgYXR0cmlidXRlczogewogICAgICBwb3NpdGlvbjogZGlmZlNQb3NpdGlvbnMsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCBwb3NpdGlvbnMKICAgICAgdGV4dHVyZUNvb3JkOiBkaWZmU1BvaW50VXZzIC8vIOWKqOaAgeS8oOWFpeeahCB1dnMKICAgIH0sCiAgICB1bmlmb3JtczogewogICAgICBwb2ludFdpZHRoOiBjdXJQb2ludFdpZHRoLAogICAgICBkYXRhU2NhbGVNYXRyaXg6IHRoYXQud2ViR0xNYXRyaWNlcy5kYXRhU2NhbGVNYXRyaXgsCiAgICAgIHpvb21NYXRyaXg6IHpvb21NYXRyaXgsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCB6b29tTWF0cml4CiAgICAgIG5vcm1hbGl6ZU1hdHJpeDogdGhhdC53ZWJHTE1hdHJpY2VzLm5vcm1hbGl6ZU1hdHJpeCwKICAgICAgYWxwaGE6IHBvaW50QWxwaGEsCiAgICAgIC8vIOmAj+aYjuW6pgogICAgICB1c2VyQWxwaGE6IC0xLAogICAgICAvLyDnlKjmiLfoh6rlrprkuYnpgI/mmI7luqYKICAgICAgdGV4dHVyZTogdGV4dHVyZSAvLyDkvKDpgJLnurnnkIbmlbDmja4KICAgIH0sCiAgICBibGVuZDogewogICAgICBlbmFibGU6IHRydWUsCiAgICAgIC8vIOWQr+eUqOa3t+WQiAogICAgICBmdW5jOiB7CiAgICAgICAgc3JjUkdCOiAnb25lJywKICAgICAgICAvLyBSR0LmupDmt7flkIjlm6DlrZAKICAgICAgICBzcmNBbHBoYTogJ29uZScsCiAgICAgICAgLy8gQWxwaGHmupDmt7flkIjlm6DlrZAKICAgICAgICBkc3RSR0I6ICdvbmUgbWludXMgc3JjIGFscGhhJywKICAgICAgICAvLyBSR0Lnm67moIfmt7flkIjlm6DlrZAKICAgICAgICBkc3RBbHBoYTogJ29uZSBtaW51cyBzcmMgYWxwaGEnIC8vIEFscGhh55uu5qCH5re35ZCI5Zug5a2QCiAgICAgIH0KICAgIH0sCiAgICBjb3VudDogZGlmZlNQb2ludENvdW50LAogICAgLy8g5Yqo5oCB5Lyg5YWl55qE54K55pWwCiAgICBwcmltaXRpdmU6ICdwb2ludHMnIC8vIOe7mOWItueCuQogIH0pOwogIGlmIChkaWZmU0xpc3QubGVuZ3RoID4gMCkgewogICAgZHJhd0RpZmZTUG9pbnRzKCk7CiAgfQoKICAvLyBDb2xsZWN0IHBvc2l0aW9uIGFuZCBjb2xvciBmb3IgZWFjaCBwb2ludAogIHZhciBzdGFydE5vZGVQb3NpdGlvbnMgPSBbXTsKICB2YXIgc3RhcnROb2RlUG9pbnRVdnMgPSBbXTsKICB2YXIgX2l0ZXJhdG9yMTMgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihzdGFydE5vZGUpLAogICAgX3N0ZXAxMzsKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3IxMy5zKCk7ICEoX3N0ZXAxMyA9IF9pdGVyYXRvcjEzLm4oKSkuZG9uZTspIHsKICAgICAgdmFyIF9wb2ludDQgPSBfc3RlcDEzLnZhbHVlOwogICAgICBzdGFydE5vZGVQb3NpdGlvbnMucHVzaChbX3BvaW50NC54LCBfcG9pbnQ0LnldKTsKICAgICAgc3RhcnROb2RlUG9pbnRVdnMucHVzaChbMC4zLCAwLjNdKTsKICAgIH0KCiAgICAvLyBBZGp1c3QgcG9pbnQgd2lkdGggYmFzZWQgb24gdGhlIG51bWJlciBvZiBwb2ludHMgdG8gZHJhdwogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yMTMuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3IxMy5mKCk7CiAgfQogIHZhciBzdGFydE5vZGVQb2ludENvdW50ID0gc3RhcnROb2RlUG9zaXRpb25zLmxlbmd0aDsKICB2YXIgZHJhd3N0YXJ0Tm9kZVBvaW50cyA9IHRoYXQuc2VhcmNoUG9pbnRSZWdsKHsKICAgIGRlcHRoOiB7CiAgICAgIGVuYWJsZTogZmFsc2UKICAgIH0sCiAgICAvLyDnpoHnlKjmt7HluqbmtYvor5UKICAgIHN0ZW5jaWw6IHsKICAgICAgZW5hYmxlOiBmYWxzZQogICAgfSwKICAgIC8vIOemgeeUqOaooeadv+e8k+WGsuWMugogICAgZnJhZzogZnJhZ21lbnRTaGFkZXIsCiAgICAvLyDniYfmrrXnnYDoibLlmagKICAgIHZlcnQ6IHZlcnRleFNoYWRlciwKICAgIC8vIOmhtueCueedgOiJsuWZqAoKICAgIGF0dHJpYnV0ZXM6IHsKICAgICAgcG9zaXRpb246IHN0YXJ0Tm9kZVBvc2l0aW9ucywKICAgICAgLy8g5Yqo5oCB5Lyg5YWl55qEIHBvc2l0aW9ucwogICAgICB0ZXh0dXJlQ29vcmQ6IHN0YXJ0Tm9kZVBvaW50VXZzIC8vIOWKqOaAgeS8oOWFpeeahCB1dnMKICAgIH0sCiAgICB1bmlmb3JtczogewogICAgICBwb2ludFdpZHRoOiBjdXJQb2ludFdpZHRoLAogICAgICBkYXRhU2NhbGVNYXRyaXg6IHRoYXQud2ViR0xNYXRyaWNlcy5kYXRhU2NhbGVNYXRyaXgsCiAgICAgIHpvb21NYXRyaXg6IHpvb21NYXRyaXgsCiAgICAgIC8vIOWKqOaAgeS8oOWFpeeahCB6b29tTWF0cml4CiAgICAgIG5vcm1hbGl6ZU1hdHJpeDogdGhhdC53ZWJHTE1hdHJpY2VzLm5vcm1hbGl6ZU1hdHJpeCwKICAgICAgYWxwaGE6IHBvaW50QWxwaGEsCiAgICAgIC8vIOmAj+aYjuW6pgogICAgICB1c2VyQWxwaGE6IC0xLAogICAgICAvLyDnlKjmiLfoh6rlrprkuYnpgI/mmI7luqYKICAgICAgdGV4dHVyZTogdGV4dHVyZSAvLyDkvKDpgJLnurnnkIbmlbDmja4KICAgIH0sCiAgICBibGVuZDogewogICAgICBlbmFibGU6IHRydWUsCiAgICAgIC8vIOWQr+eUqOa3t+WQiAogICAgICBmdW5jOiB7CiAgICAgICAgc3JjUkdCOiAnb25lJywKICAgICAgICAvLyBSR0LmupDmt7flkIjlm6DlrZAKICAgICAgICBzcmNBbHBoYTogJ29uZScsCiAgICAgICAgLy8gQWxwaGHmupDmt7flkIjlm6DlrZAKICAgICAgICBkc3RSR0I6ICdvbmUgbWludXMgc3JjIGFscGhhJywKICAgICAgICAvLyBSR0Lnm67moIfmt7flkIjlm6DlrZAKICAgICAgICBkc3RBbHBoYTogJ29uZSBtaW51cyBzcmMgYWxwaGEnIC8vIEFscGhh55uu5qCH5re35ZCI5Zug5a2QCiAgICAgIH0KICAgIH0sCiAgICBjb3VudDogc3RhcnROb2RlUG9pbnRDb3VudCwKICAgIC8vIOWKqOaAgeS8oOWFpeeahOeCueaVsAogICAgcHJpbWl0aXZlOiAncG9pbnRzJyAvLyDnu5jliLbngrkKICB9KTsKICBpZiAoc3RhcnROb2RlLmxlbmd0aCA+IDApIHsKICAgIGRyYXdzdGFydE5vZGVQb2ludHMoKTsKICB9Cn0KZXhwb3J0IGZ1bmN0aW9uIGRyYXdTZWFyY2hTY2F0dGVyUGxvdDIodGhhdCkgewogIGlmICghdGhhdC53ZWJHTE1hdHJpY2VzKSB7CiAgICB0aHJvdyBFcnJvcignd2ViR0xNYXRyaWNlcyBub3QgaW5pdGlhbGl6ZWQnKTsKICB9CgogIC8vIENsZWFyIHRoZSBXZWJHTCBjb250ZXh0CiAgdGhhdC5zZWFyY2hQb2ludFJlZ2wuY2xlYXIoewogICAgY29sb3I6IFswLCAwLCAwLCAwXSwKICAgIGRlcHRoOiAxCiAgfSk7CgogIC8vIEFkanVzdCBwb2ludCB3aWR0aCBiYXNlZCBvbiB0aGUgbnVtYmVyIG9mIHBvaW50cyB0byBkcmF3CiAgY29uc29sZS5sb2coInRoYXQuc2VhcmNoUG9pbnRSZXN1bHRzMiIsIHRoYXQuc2VhcmNoUG9pbnRSZXN1bHRzMik7CiAgdmFyIHBvaW50Q291bnQgPSB0aGF0LnNlYXJjaFBvaW50UmVzdWx0czIubGVuZ3RoOwogIGNvbnNvbGUubG9nKCJ0aGF0LnNlYXJjaFBvaW50UmVzdWx0czIiLCBwb2ludENvdW50KTsKCiAgLy8gTG9nYXJpdGhtaWMgcmVncmVzc2lvbiBwYXJhbWV0ZXJzCiAgdmFyIGEgPSA2LjcxNjgyMDcxOwogIHZhciBiID0gLTAuNDM3OTc0ODcxOwogIHZhciBjdXJQb2ludFdpZHRoID0gYSArIGIgKiBNYXRoLmxvZyhjb25maWcubGF5b3V0LnNjYXR0ZXJEb3RSYWRpdXMgKiAodGhhdC5zdmdGdWxsU2l6ZS5oZWlnaHQgLyA3NjApICogcG9pbnRDb3VudCk7CiAgY3VyUG9pbnRXaWR0aCA9IE1hdGgubWluKDUsIGN1clBvaW50V2lkdGgpOwogIHZhciBhbHBoYSA9IDEgLyAoTWF0aC5sb2cocG9pbnRDb3VudCkgLyBNYXRoLmxvZyg1MDApKTsKCiAgLy8gR2V0IHRoZSBjdXJyZW50IHpvb20gbWF0cml4CiAgdmFyIHpvb21NYXRyaXggPSBnZXRab29tTWF0cml4KHRoYXQuY3VyWm9vbVRyYW5zZm9ybSk7CgogIC8vIENyZWF0ZSBhIHRleHR1cmUgYXJyYXkgZm9yIHBvaW50IGNvbG9ycwogIHZhciB0ZXh0dXJlQXJyYXkgPSBbY29uZmlnLmxheW91dC50aW1lUG9pbnRDb2xvckludFswXSwgY29uZmlnLmxheW91dC50aW1lUG9pbnRDb2xvckludFsxXSwgY29uZmlnLmxheW91dC50aW1lUG9pbnRDb2xvckludFsyXSwgMjU1LCBjb25maWcubGF5b3V0LnNlY29uZFBvaW50Q29sb3JJbnRbMF0sIGNvbmZpZy5sYXlvdXQuc2Vjb25kUG9pbnRDb2xvckludFsxXSwgY29uZmlnLmxheW91dC5zZWNvbmRQb2ludENvbG9ySW50WzJdLCAyNTUsIDI1NSwgMjU1LCAyNTUsIDBdOwogIHZhciB0ZXh0dXJlID0gdGhhdC5zZWFyY2hQb2ludFJlZ2wudGV4dHVyZSh7CiAgICB3aWR0aDogMywKICAgIGhlaWdodDogMSwKICAgIGRhdGE6IHRleHR1cmVBcnJheSwKICAgIGZvcm1hdDogJ3JnYmEnCiAgfSk7CgogIC8vIENvbGxlY3QgcG9zaXRpb25zIGFuZCB0ZXh0dXJlIGNvb3JkaW5hdGVzIGZvciBlYWNoIHBvaW50CiAgdmFyIHBvc2l0aW9ucyA9IFtdOwogIHZhciB1dnMgPSBbXTsKICBjb25zb2xlLmxvZygidGhhdC5zZWFyY2hQb2ludFJlc3VsdHMyMjIyMjIiLCB0aGF0LnNlYXJjaFBvaW50UmVzdWx0czIpOwogIHZhciBfaXRlcmF0b3IxNCA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKHRoYXQuc2VhcmNoUG9pbnRSZXN1bHRzMiksCiAgICBfc3RlcDE0OwogIHRyeSB7CiAgICBmb3IgKF9pdGVyYXRvcjE0LnMoKTsgIShfc3RlcDE0ID0gX2l0ZXJhdG9yMTQubigpKS5kb25lOykgewogICAgICB2YXIgcG9pbnQgPSBfc3RlcDE0LnZhbHVlOwogICAgICBwb3NpdGlvbnMucHVzaChbcG9pbnQueCwgcG9pbnQueV0pOwogICAgICB1dnMucHVzaChbMCwgMF0pOwogICAgfQogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yMTQuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3IxNC5mKCk7CiAgfQogIHZhciBkcmF3UG9pbnRzID0gdGhhdC5zZWFyY2hQb2ludFJlZ2woewogICAgZGVwdGg6IHsKICAgICAgZW5hYmxlOiBmYWxzZQogICAgfSwKICAgIHN0ZW5jaWw6IHsKICAgICAgZW5hYmxlOiBmYWxzZQogICAgfSwKICAgIGZyYWc6IGZyYWdtZW50U2hhZGVyLAogICAgdmVydDogdmVydGV4U2hhZGVyLAogICAgYXR0cmlidXRlczogewogICAgICBwb3NpdGlvbjogcG9zaXRpb25zLAogICAgICB0ZXh0dXJlQ29vcmQ6IHV2cwogICAgfSwKICAgIHVuaWZvcm1zOiB7CiAgICAgIHBvaW50V2lkdGg6IGN1clBvaW50V2lkdGgsCiAgICAgIGRhdGFTY2FsZU1hdHJpeDogdGhhdC53ZWJHTE1hdHJpY2VzLmRhdGFTY2FsZU1hdHJpeCwKICAgICAgem9vbU1hdHJpeDogem9vbU1hdHJpeCwKICAgICAgbm9ybWFsaXplTWF0cml4OiB0aGF0LndlYkdMTWF0cmljZXMubm9ybWFsaXplTWF0cml4LAogICAgICBhbHBoYTogYWxwaGEsCiAgICAgIHVzZXJBbHBoYTogLTEsCiAgICAgIHRleHR1cmU6IHRleHR1cmUKICAgIH0sCiAgICBibGVuZDogewogICAgICBlbmFibGU6IHRydWUsCiAgICAgIGZ1bmM6IHsKICAgICAgICBzcmNSR0I6ICdvbmUnLAogICAgICAgIHNyY0FscGhhOiAnb25lJywKICAgICAgICBkc3RSR0I6ICdvbmUgbWludXMgc3JjIGFscGhhJywKICAgICAgICBkc3RBbHBoYTogJ29uZSBtaW51cyBzcmMgYWxwaGEnCiAgICAgIH0KICAgIH0sCiAgICBjb3VudDogcG9pbnRDb3VudCwKICAgIHByaW1pdGl2ZTogJ3BvaW50cycKICB9KTsKICBkcmF3UG9pbnRzKCk7CiAgY29uc29sZS5sb2coInRoYXQuc2VhcmNoUG9pbnRSZXN1bHRzMzMzMyIsIHRoYXQuc2VhcmNoUG9pbnRSZXN1bHRzMik7Cn0KZXhwb3J0IHZhciBhbnlUcnVlID0gZnVuY3Rpb24gYW55VHJ1ZShpdGVtcykgewogIHJldHVybiBpdGVtcy5yZWR1Y2UoZnVuY3Rpb24gKGEsIGIpIHsKICAgIHJldHVybiBhIHx8IGI7CiAgfSk7Cn07CmV4cG9ydCB2YXIgYWxsVHJ1ZSA9IGZ1bmN0aW9uIGFsbFRydWUoaXRlbXMpIHsKICByZXR1cm4gaXRlbXMucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7CiAgICByZXR1cm4gYSAmJiBiOwogIH0pOwp9Ow=="},{"version":3,"names":["d3","config","updatePopperTooltip","fragmentShader","vertexShader","Labeler","edgeFragmentShader","edgeVertexShader","pointMouseenterTimer","pointMouseleaveTimer","initWebGLMatrices","that","xDomainMid","xScale","domain","yDomainMid","yScale","xRangeMid","range","yRangeMid","xMultiplier","yMultiplier","dataScaleMatrix","dataScaleMatrix1D","flat","normalizeMatrix","svgFullSize","width","height","normalizeMatrix1D","webGLMatrices","initWebGLBuffers","gridData","Error","positions","textureCoords","_iterator","_createForOfIteratorHelper","promptPoints","_step","s","n","done","point","value","push","x","y","err","e","f","totalPointSize","frontPositionBuffer","pointRegl","buffer","length","type","usage","subdata","frontTextureCoordinateBuffer","frontBufferPointSize","drawScatterPlot","clear","color","depth","pointCount","loadedPointCount","a","b","curPointWidth","Math","log","layout","scatterDotRadius","min","max","alpha","zoomMatrix","getZoomMatrix","curZoomTransform","textureArray","defaultPointColorInt","secondPointColorInt","texture","data","format","userAlpha","opacity","undefined","drawPoints","enable","stencil","frag","vert","attributes","position","stride","offset","textureCoord","uniforms","pointWidth","blend","func","srcRGB","srcAlpha","dstRGB","dstAlpha","count","primitive","drawContour","console","error","contourGroup","svg","select","gridData1D","grid","_iterator2","_step2","row","_iterator3","_step3","item","levels","contourLevels","thresholds","minValue","apply","maxValue","step","i","contours","size","contourXScale","scaleLinear","xRange","contourYScale","yRange","map","coordinates","colorScaleInterpolator","interpolateLab","colorScale","scaleSequential","extent","d","selectAll","slice","join","attr","geoPath","drawGroupContour","group","_that$groupNames","groupGrids","concat","_iterator4","_step4","_iterator5","_step5","groupNames","indexOf","zoomTransform","k","zoomMatrix1D","updateWebGLBuffers","newPoints","_iterator6","_step6","timeTextureMap","groupID","has","time","u","get","highlightPoint","args","offx","animated","anyTrue","showPoints","hoverPoint","hideHighlights","topSvg","oldHighlightPoint","clearTimeout","setTimeout","tooltipTop","classList","add","remove","$store","state","datasetName","image","imageGroup","prompt","imageURLPrefix","highlightRadius","exp","highlightStroke","curHighlightPoint","empty","append","style","transition","duration","on","node","getCoordinates","nodesIdList","_iterator7","_step7","resultIndex","curPoint","drawSearchScatterPlot","dataNodeLink","links","searchPointRegl","connectData","nodeList","nodes","startNode","searchList","sList","groundTruthList","gList","diffSList","filter","includes","diffGList","interList","tracePoints","_iterator8","_step8","id","edgePositions","_iterator9","_step9","link","startPoint","source","endPoint","target","curLineWidth","lineCount","lineAlpha","timePointColorInt","lineUvs","drawLines","LineWidth","allpointPositions","allpointUvs","_i","_tracePoints","allpointCount","pointAlpha","drawAllPoints","interPositions","interPointUvs","_iterator10","_step10","_point","interPointCount","drawInterPoints","diffGPositions","diffGPointUvs","_iterator11","_step11","_point2","diffGPointCount","drawDiffGPoints","diffSPositions","diffSPointUvs","_iterator12","_step12","_point3","diffSPointCount","drawDiffSPoints","startNodePositions","startNodePointUvs","_iterator13","_step13","_point4","startNodePointCount","drawstartNodePoints","drawSearchScatterPlot2","searchPointResults2","uvs","_iterator14","_step14","items","reduce","allTrue"],"sources":["/home/yansha/VDProject/VDFrontend/src/components/Embedding/EmbeddingPointWebGL.js"],"sourcesContent":["import d3 from '../../utils/d3-import';\nimport { config } from '../../config/config';\nimport { updatePopperTooltip } from './EmbeddingLabel';\nimport fragmentShader from './shaders/point.frag?raw';\nimport vertexShader from './shaders/point.vert?raw';\nimport * as Labeler from './EmbeddingLabel';\n\nimport edgeFragmentShader from './shaders/edge.frag?raw';\nimport edgeVertexShader from './shaders/edge.vert?raw';\n\nlet pointMouseenterTimer = null;\nlet pointMouseleaveTimer = null;\n\nexport function initWebGLMatrices(that) {\n    // Convert the x and y scales to a matrix (applying scale is cheaper in GPU)\n\n    const xDomainMid = (that.xScale.domain()[0] + that.xScale.domain()[1]) / 2;\n    const yDomainMid = (that.yScale.domain()[0] + that.yScale.domain()[1]) / 2;\n\n    const xRangeMid = (that.xScale.range()[0] + that.xScale.range()[1]) / 2;\n    const yRangeMid = (that.yScale.range()[0] + that.yScale.range()[1]) / 2;\n\n    const xMultiplier =\n        (that.xScale.range()[1] - that.xScale.range()[0]) /\n        (that.xScale.domain()[1] - that.xScale.domain()[0]);\n\n    const yMultiplier =\n        (that.yScale.range()[1] - that.yScale.range()[0]) /\n        (that.yScale.domain()[1] - that.yScale.domain()[0]);\n\n    // WebGL is column-major!\n    // Transform from data space to stage space (same as applying that.xScale(),\n    // and that.yScale())\n\n    const dataScaleMatrix = [\n        [xMultiplier, 0, -xMultiplier * xDomainMid + xRangeMid],\n        [0, yMultiplier, -yMultiplier * yDomainMid + yRangeMid],\n        [0, 0, 1]\n    ];\n\n    // \n    // dataScaleMatrix[0][2] += (that.svgFullSize.width / 2 - xRangeMid);\n    // dataScaleMatrix[1][2] += (that.svgFullSize.height / 2 - yRangeMid);\n    const dataScaleMatrix1D = dataScaleMatrix.flat();\n\n    // Transforming the stage space to the normalized coordinate\n    // Note we need to flip the y coordinate\n    const normalizeMatrix = [\n        [2 / that.svgFullSize.width, 0, -1],\n        [0, -2 / that.svgFullSize.height, 1],\n        [0, 0, 1]\n    ];\n\n    const normalizeMatrix1D = normalizeMatrix.flat();\n\n\n    //  webGLMatrices \n    that.webGLMatrices = {\n        dataScaleMatrix: dataScaleMatrix1D,\n        normalizeMatrix: normalizeMatrix1D,\n    };\n\n}\n\nexport function initWebGLBuffers(that) {\n    if (that.gridData === null) {\n        throw new Error('GridData is null.');\n    }\n\n    // \n    const positions = [];\n    const textureCoords = [];\n\n    for (const point of that.promptPoints) {\n        positions.push([point.x, point.y]);\n        textureCoords.push([0, 0]);\n    }\n\n    let totalPointSize = that.gridData.totalPointSize;\n\n    that.frontPositionBuffer = that.pointRegl.buffer({\n        length: totalPointSize * 4 * 2,\n        type: 'float',\n        usage: 'dynamic'\n    });\n    that.frontPositionBuffer.subdata(positions, 0);\n\n    that.frontTextureCoordinateBuffer = that.pointRegl.buffer({\n        length: totalPointSize * 4 * 2,\n        type: 'float',\n        usage: 'dynamic'\n    });\n    that.frontTextureCoordinateBuffer.subdata(textureCoords, 0);\n    that.frontBufferPointSize = that.promptPoints.length;\n}\n\n/**\n * Draw a scatter plot for the UMAP.\n */\nexport function drawScatterPlot(that) {\n    if (!that.webGLMatrices) {\n        throw Error('webGLMatrices not initialized');\n    }\n\n    that.pointRegl.clear({\n        color: [0, 0, 0, 0],\n        depth: 1\n    });\n\n    // Adjust point width based on the number of points to draw\n    let pointCount = that.loadedPointCount;\n\n\n    // Logarithmic regression by fitting the following three points\n    // https://keisan.casio.com/exec/system/14059930226691\n    // [(6e4, 2), (3e5, 1), [1.8e6, 0.5]]\n    const a = 6.71682071;\n    const b = -0.437974871;\n    that.curPointWidth =\n        a +\n        b *\n        Math.log(\n            config.layout.scatterDotRadius *\n            (that.svgFullSize.height / 10000000) *\n            pointCount\n        );\n    that.curPointWidth = Math.min(5, that.curPointWidth);\n    that.curPointWidth = Math.max(0.4, that.curPointWidth);\n    const alpha = 1 / (Math.log(pointCount) / Math.log(500));\n\n    // Get the current zoom\n    const zoomMatrix = getZoomMatrix(that.curZoomTransform);\n\n    // Create a texture array (default 3x1)\n    let textureArray = [\n        config.layout.defaultPointColorInt[0],\n        config.layout.defaultPointColorInt[1],\n        config.layout.defaultPointColorInt[2],\n        255,\n        config.layout.secondPointColorInt[0],\n        config.layout.secondPointColorInt[1],\n        config.layout.secondPointColorInt[2],\n        255,\n        255,\n        255,\n        255,\n        0\n    ];\n    // [default color, second color, transparent, empty]\n    const texture = that.pointRegl.texture({\n        width: 3,\n        height: 1,\n        data: textureArray,\n        format: 'rgba'\n    });\n\n    // If user specifies an alpha level, we use it to override auto-alpha\n    let userAlpha = -1.0;\n    if (that.gridData && that.gridData.opacity !== undefined) {\n        userAlpha = Math.max(0, Math.min(that.gridData.opacity, 1));\n    }\n\n    const drawPoints = that.pointRegl({\n        depth: { enable: false },\n        stencil: { enable: false },\n        frag: fragmentShader,\n        vert: vertexShader,\n\n        attributes: {\n            position: {\n                buffer: that.frontPositionBuffer,\n                stride: 2 * 4,\n                offset: 0\n            },\n            textureCoord: {\n                buffer: that.frontTextureCoordinateBuffer,\n                stride: 2 * 4,\n                offset: 0\n            }\n        },\n        uniforms: {\n            // Placeholder for function parameters\n            pointWidth: 1.2,\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix,\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            alpha: alpha,\n            userAlpha: userAlpha,\n            texture: texture\n        },\n        blend: {\n            enable: true,\n            func: {\n                srcRGB: 'one',\n                srcAlpha: 'one',\n                dstRGB: 'one minus src alpha',\n                dstAlpha: 'one minus src alpha'\n            }\n        },\n\n        count: that.frontBufferPointSize,\n        primitive: 'points'\n    });\n\n    drawPoints();\n}\n\nexport function drawContour(that) {\n\n    if (that.gridData == null) {\n        console.error('Grid data not initialized');\n        return null;\n    }\n\n    const contourGroup = that.svg.select(`.contour-group`);\n\n    const gridData1D = [];\n    const grid = that.gridData.grid;\n    for (const row of grid) {\n        for (const item of row) {\n            gridData1D.push(item);\n        }\n    }\n\n    // Linear interpolate the levels to determine the thresholds\n    const levels = config.layout.contourLevels;\n    const thresholds = [];\n    const minValue = Math.min(...gridData1D);\n    const maxValue = Math.max(...gridData1D);\n    const step = (maxValue - minValue) / levels;\n    for (let i = 0; i < levels; i++) {\n        thresholds.push(minValue + step * i);\n    }\n\n    let contours = d3\n        .contours()\n        .thresholds(thresholds)\n        .size([grid.length, grid[0].length])(gridData1D);\n\n    // Convert the scale of the generated paths\n    const contourXScale = d3\n        .scaleLinear()\n        .domain([0, grid.length])\n        .range(that.gridData.xRange);\n\n    const contourYScale = d3\n        .scaleLinear()\n        .domain([0, grid[0].length])\n        .range(that.gridData.yRange);\n\n    contours = contours.map(item => {\n        item.coordinates = item.coordinates.map(coordinates => {\n            return coordinates.map(positions => {\n                return positions.map(point => {\n                    return [\n                        that.xScale(contourXScale(point[0])),\n                        // that.xScale(contourXScale(point[0])) + (that.svgFullSize.width - that.svgFullSize.height) / 2,\n                        that.yScale(contourYScale(point[1]))\n                    ];\n                });\n            });\n        });\n        return item;\n    });\n\n    // Create a new color interpolator\n    // (starting from white here)\n    const colorScaleInterpolator = d3.interpolateLab(\n        '#ffffff',\n        config.layout['groupColors'][0]\n    );\n    const colorScale = d3.scaleSequential(\n        d3.extent(thresholds),\n        d => colorScaleInterpolator(d / 1)\n    );\n\n    // Draw the contours\n    contourGroup\n        .selectAll('path')\n        .data(contours.slice(1))\n        .join('path')\n        .attr('fill', d => colorScale(d.value))\n        .attr('d', d3.geoPath());\n\n    return contours;\n};\n\n\nexport function drawGroupContour(that, group) {\n\n\n    if (that.gridData == null || that.gridData.groupGrids == undefined) {\n        console.error('Grid data not initialized', that.gridData);\n        return null;\n    }\n\n    const contourGroup = that.svg.select(`.contour-group-${group}`);\n\n    const gridData1D = [];\n    const grid = that.gridData.groupGrids[group];\n    for (const row of grid) {\n        for (const item of row) {\n            gridData1D.push(item);\n        }\n    }\n\n    // Linear interpolate the levels to determine the thresholds\n    const levels = config.layout.contourLevels;\n    const thresholds = [];\n    const minValue = Math.min(...gridData1D);\n    const maxValue = Math.max(...gridData1D);\n    const step = (maxValue - minValue) / levels;\n    for (let i = 0; i < levels; i++) {\n        thresholds.push(minValue + step * i);\n    }\n\n    let contours = d3\n        .contours()\n        .thresholds(thresholds)\n        .size([grid.length, grid[0].length])(gridData1D);\n\n    // Convert the scale of the generated paths\n    const contourXScale = d3\n        .scaleLinear()\n        .domain([0, grid.length])\n        .range(that.gridData.xRange);\n\n    const contourYScale = d3\n        .scaleLinear()\n        .domain([0, grid[0].length])\n        .range(that.gridData.yRange);\n\n    contours = contours.map(item => {\n        item.coordinates = item.coordinates.map(coordinates => {\n            return coordinates.map(positions => {\n                return positions.map(point => {\n                    return [\n                        that.xScale(contourXScale(point[0])),\n                        // that.xScale(contourXScale(point[0])) + (that.svgFullSize.width - that.svgFullSize.height) / 2,\n                        that.yScale(contourYScale(point[1]))\n                    ];\n                });\n            });\n        });\n        return item;\n    });\n\n    // Create a new color interpolator\n    // (starting from white here)\n    const colorScaleInterpolator = d3.interpolateLab(\n        '#ffffff',\n        config.layout['groupColors'][that.groupNames?.indexOf(group) || 0]\n    );\n    const colorScale = d3.scaleSequential(\n        d3.extent(thresholds),\n        d => colorScaleInterpolator(d / 1)\n    );\n\n    // Draw the contours\n    contourGroup\n        .selectAll('path')\n        .data(contours.slice(1))\n        .join('path')\n        .attr('fill', d => colorScale(d.value))\n        .attr('d', d3.geoPath());\n\n    return contours;\n};\n\n/**\n * Convert the current zoom transform into a matrix\n * @param zoomTransform D3 zoom transform\n * @returns 1D matrix\n */\nconst getZoomMatrix = (zoomTransform) => {\n    // Transforming the stage space based on the current zoom transform\n    const zoomMatrix = [\n        [zoomTransform.k, 0, zoomTransform.x],\n        [0, zoomTransform.k, zoomTransform.y],\n        [0, 0, 1]\n    ];\n    const zoomMatrix1D = zoomMatrix.flat();\n    return zoomMatrix1D;\n};\n\nexport function updateWebGLBuffers(that, newPoints) {\n    // Get the position and color of each new point\n    const positions = [];\n    const textureCoords = [];\n\n    for (const point of newPoints) {\n        positions.push([point.x, point.y]);\n\n        if (that.timeTextureMap === null) {\n            if (that.groupNames && point.groupID !== undefined) {\n                textureCoords.push([point.groupID / that.groupNames.length, 0]);\n            } else {\n                textureCoords.push([0, 0]);\n            }\n        } else {\n            if (that.timeTextureMap.has(point.time)) {\n                const u =\n                    that.timeTextureMap.get(point.time) /\n                    (that.timeTextureMap.size - 1);\n                textureCoords.push([u, 0.5]);\n            } else {\n                // The last entry in the texture array is reserved for 'bad' points\n                // (e.g., wrong year)\n                textureCoords.push([1, 0]);\n            }\n        }\n    }\n\n    // Update the buffer using byte offsets\n    that.frontPositionBuffer.subdata(\n        positions,\n        that.frontBufferPointSize * 2 * 4\n    );\n    that.frontTextureCoordinateBuffer.subdata(\n        textureCoords,\n        that.frontBufferPointSize * 2 * 4\n    );\n    that.frontBufferPointSize += newPoints.length;\n}\n\nexport function highlightPoint(that, args) {\n    const offx = 0;\n    const { point, animated } = args;\n    if (!anyTrue(that.showPoints)) return;\n    if (point === that.hoverPoint) return;\n    if (that.hideHighlights) return;\n\n    // Draw the point on the top svg\n    const group = that.topSvg.select('g.top-content g.highlights');\n    const oldHighlightPoint = group.select('circle.highlight-point');\n\n    //  \n\n    // Hovering empty space\n    if (point === undefined) {\n        if (pointMouseleaveTimer !== null) {\n            clearTimeout(pointMouseleaveTimer);\n            pointMouseleaveTimer = null;\n        }\n\n        if (pointMouseenterTimer !== null) {\n            clearTimeout(pointMouseenterTimer);\n            pointMouseenterTimer = null;\n        }\n\n        // Clear the highlight and tooltip in a short delay\n        pointMouseleaveTimer = setTimeout(() => {\n            that.hoverPoint = null;\n            that.tooltipTop.classList.add('hidden');\n            oldHighlightPoint.remove();\n            pointMouseleaveTimer = null;\n        }, 50);\n\n        return;\n    }\n\n    // Hovering over a point\n    that.hoverPoint = point;\n    if (that.$store.state.datasetName == \"ImageNet2012ValSet\") {\n        that.hoverPoint.groupID = 0;\n    }\n\n    // that.hoverPoint.groupID = 0;\n    // Change the point's text to an image tag if this is an image point\n\n\n    if (that.gridData && that.gridData.image !== undefined) {\n        if (that.gridData.image.imageGroup === that.hoverPoint.groupID) {\n            console.log(\"that.hoverPoint\", that.hoverPoint, that.hoverPoint.prompt)\n\n            that.hoverPoint.prompt = `<img class=\"tooltip-image\" src=\"${that.gridData.image.imageURLPrefix + that.hoverPoint.prompt}\">`;\n        }\n    }\n\n\n\n    if (pointMouseleaveTimer !== null) {\n        clearTimeout(pointMouseleaveTimer);\n        pointMouseleaveTimer = null;\n    }\n\n    const highlightRadius = Math.max(\n        10 / that.curZoomTransform.k,\n        (that.curPointWidth * Math.exp(Math.log(that.curZoomTransform.k) * 0.55)) / that.curZoomTransform.k\n    );\n\n    const highlightStroke = 1.2 / that.curZoomTransform.k;\n    let curHighlightPoint; // \n\n    // \n    if (oldHighlightPoint.empty()) {\n        curHighlightPoint = group\n            .append('circle')\n            .attr('class', 'highlight-point')\n            .attr('cx', that.xScale(point.x) + offx)\n            .attr('cy', that.yScale(point.y))\n            .attr('r', highlightRadius)\n            .style('stroke-width', highlightStroke);\n    } else {\n        // \n        curHighlightPoint = oldHighlightPoint;\n\n        if (animated) {\n            curHighlightPoint\n                .transition()\n                .duration(150)\n                .attr('cx', that.xScale(point.x) + offx)\n                .attr('cy', that.yScale(point.y))\n                .attr('r', highlightRadius)\n                .style('stroke-width', highlightStroke)\n                .on('end', () => {\n                    updatePopperTooltip(\n                        that.tooltipTop,\n                        curHighlightPoint.node(),\n                        point.prompt,\n                        'top'\n                    );\n                });\n        } else {\n            curHighlightPoint\n                .attr('cx', that.xScale(point.x) + offx)\n                .attr('cy', that.yScale(point.y))\n                .attr('r', highlightRadius)\n                .style('stroke-width', highlightStroke);\n\n            updatePopperTooltip(\n                that.tooltipTop,\n                curHighlightPoint.node(),\n                point.prompt,\n                'top'\n            );\n        }\n    }\n\n    if (pointMouseenterTimer !== null) {\n        clearTimeout(pointMouseenterTimer);\n    }\n\n    pointMouseenterTimer = setTimeout(() => {\n        that.tooltipTop.classList.remove('hidden');\n        pointMouseenterTimer = null;\n    }, 300);\n}\n\nfunction getCoordinates(nodesIdList, promptPoints) {\n    const coordinates = [];\n    for (const resultIndex of nodesIdList) {\n        const curPoint = promptPoints[resultIndex];\n        coordinates.push(curPoint);\n    }\n    return coordinates;\n}\n\nexport function drawSearchScatterPlot(that) {\n    if (!that.webGLMatrices) {\n        throw new Error('webGLMatrices not initialized');\n    }\n\n    if (that.$store.state.dataNodeLink.links == null) {\n        return null;\n    }\n\n    that.searchPointRegl.clear({\n        color: [0, 0, 0, 0],\n        depth: 1\n    });\n\n    // Here are some code for processing data\n    let connectData = that.$store.state.dataNodeLink.links;\n    let nodeList = that.$store.state.dataNodeLink.nodes;\n    let startNode = that.$store.state.dataNodeLink.startNode;\n    let searchList = that.$store.state.dataNodeLink.sList;\n    let groundTruthList = that.$store.state.dataNodeLink.gList;\n\n    let diffSList = searchList.filter(x => !groundTruthList.includes(x));\n    let diffGList = groundTruthList.filter(x => !searchList.includes(x));\n    let interList = searchList.filter(x => groundTruthList.includes(x));\n\n    let tracePoints = [];\n\n    for (const resultIndex of nodeList) {\n        const curPoint = that.promptPoints[resultIndex.id];\n        tracePoints.push(curPoint);\n    }\n\n    let edgePositions = [];\n\n    for (const link of connectData) {\n        const startPoint = that.promptPoints[link.source];\n        const endPoint = that.promptPoints[link.target];\n\n        // \n        if (startPoint && endPoint) {\n            edgePositions.push(startPoint.x, startPoint.y, endPoint.x, endPoint.y);\n        }\n    }\n\n\n    diffGList = getCoordinates(diffGList, that.promptPoints);\n    diffSList = getCoordinates(diffSList, that.promptPoints);\n    interList = getCoordinates(interList, that.promptPoints);\n    startNode = getCoordinates([startNode], that.promptPoints);\n\n\n    const curLineWidth = 2.0; // \n    const lineCount = edgePositions.length / 4; // \n    // curPointWidth = Math.min(5, curPointWidth);\n    const lineAlpha = 1 / (Math.log(lineCount) / Math.log(500));\n\n    // // Get the current zoom\n    const zoomMatrix = getZoomMatrix(that.curZoomTransform);\n\n    // Create a texture array (default 3x1)\n    const textureArray = [\n        // timePointColorInt (RGBA)\n        config.layout.timePointColorInt[0], // R\n        config.layout.timePointColorInt[1], // G\n        config.layout.timePointColorInt[2], // B\n        255, // A\n\n        // Add yellow color (RGBA)\n        255, // R\n        255, // G\n        0,   // B\n        255,  // A\n\n        // Add blue color (RGBA)\n        0,   // R\n        0,   // G\n        255, // B\n        255, // A\n\n        // Add green color (RGBA)\n        0,   // R\n        255, // G\n        0,   // B\n        255, // A\n\n\n\n        // secondPointColorInt (RGBA)\n        config.layout.secondPointColorInt[0], // R\n        config.layout.secondPointColorInt[1], // G\n        config.layout.secondPointColorInt[2], // B\n        255, // A\n    ];\n\n    // Create texture with width 5 and height 1 (now 5 colors)\n    const texture = that.searchPointRegl.texture({\n        width: 5,\n        height: 1,\n        data: textureArray,\n        format: 'rgba'\n    });\n\n\n    const lineUvs = [];\n    for (let i = 0; i < edgePositions / 2; i++) {\n        lineUvs.push([0, 0]);\n    }\n\n    const drawLines = that.searchPointRegl({\n        depth: { enable: false },\n        stencil: { enable: false },\n        frag: edgeFragmentShader,\n        vert: edgeVertexShader,\n        attributes: {\n            position: edgePositions,\n            textureCoord: lineUvs\n        },\n\n        uniforms: {\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix,\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            LineWidth: curLineWidth,\n            alpha: lineAlpha,\n            userAlpha: -1,\n            texture: texture\n\n        },\n\n        blend: {\n            enable: true,\n            func: {\n                srcRGB: 'one',\n                srcAlpha: 'one',\n                dstRGB: 'one minus src alpha',\n                dstAlpha: 'one minus src alpha'\n            }\n        },\n\n        count: lineCount * 2,\n        primitive: 'lines',\n\n    });\n\n    drawLines();\n\n    // Collect position and color for each point\n    const allpointPositions = [];\n    const allpointUvs = [];\n\n    for (const point of tracePoints) {\n        allpointPositions.push([point.x, point.y]);\n        allpointUvs.push([0.1, 0.1]);\n    }\n    // Adjust point width based on the number of points to draw\n    const allpointCount = allpointPositions.length;\n\n    // Logarithmic regression by fitting the following three points\n    // https://keisan.casio.com/exec/system/14059930226691\n    // [(6e4, 2), (3e5, 1), [1.8e6, 0.5]]\n    const a = 6.71682071;\n    const b = -0.437974871;\n    let curPointWidth =\n        a +\n        b *\n        Math.log(\n            config.layout.scatterDotRadius *\n            (that.svgFullSize.height / 760) *\n            allpointCount\n        );\n\n    const pointAlpha = 1 / (Math.log(allpointCount) / Math.log(500));\n\n    const drawAllPoints = that.searchPointRegl({\n        depth: { enable: false }, // \n        stencil: { enable: false }, // \n        frag: fragmentShader, // \n        vert: vertexShader, // \n\n        attributes: {\n            position: allpointPositions, //  positions\n            textureCoord: allpointUvs //  uvs\n        },\n\n        uniforms: {\n            pointWidth: curPointWidth,\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix, //  zoomMatrix\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            alpha: pointAlpha, // \n            userAlpha: -1, // \n            texture: texture // \n        },\n\n        blend: {\n            enable: true, // \n            func: {\n                srcRGB: 'one', // RGB\n                srcAlpha: 'one', // Alpha\n                dstRGB: 'one minus src alpha', // RGB\n                dstAlpha: 'one minus src alpha' // Alpha\n            }\n        },\n\n        count: allpointCount, // \n        primitive: 'points' // \n    });\n\n    drawAllPoints();\n\n\n    // Collect position and color for each point\n    const interPositions = [];\n    const interPointUvs = [];\n\n    for (const point of interList) {\n        interPositions.push([point.x, point.y]);\n        interPointUvs.push([1.0, 1.0]);\n    }\n\n    // Adjust point width based on the number of points to draw\n    const interPointCount = interPositions.length;\n    const drawInterPoints = that.searchPointRegl({\n        depth: { enable: false }, // \n        stencil: { enable: false }, // \n        frag: fragmentShader, // \n        vert: vertexShader, // \n\n        attributes: {\n            position: interPositions, //  positions\n            textureCoord: interPointUvs //  uvs\n        },\n\n        uniforms: {\n            pointWidth: curPointWidth,\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix, //  zoomMatrix\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            alpha: pointAlpha, // \n            userAlpha: -1, // \n            texture: texture // \n        },\n\n        blend: {\n            enable: true, // \n            func: {\n                srcRGB: 'one', // RGB\n                srcAlpha: 'one', // Alpha\n                dstRGB: 'one minus src alpha', // RGB\n                dstAlpha: 'one minus src alpha' // Alpha\n            }\n        },\n\n        count: interPointCount, // \n        primitive: 'points' // \n    });\n    if (interList.length > 0) {\n        drawInterPoints();\n    }\n\n\n    // Collect position and color for each point\n    const diffGPositions = [];\n    const diffGPointUvs = [];\n\n    for (const point of diffGList) {\n        diffGPositions.push([point.x, point.y]);\n        diffGPointUvs.push([0.3, 0.3]);\n    }\n\n    // Adjust point width based on the number of points to draw\n    const diffGPointCount = diffGPositions.length;\n\n    const drawDiffGPoints = that.searchPointRegl({\n        depth: { enable: false }, // \n        stencil: { enable: false }, // \n        frag: fragmentShader, // \n        vert: vertexShader, // \n\n        attributes: {\n            position: diffGPositions, //  positions\n            textureCoord: diffGPointUvs //  uvs\n        },\n\n        uniforms: {\n            pointWidth: curPointWidth,\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix, //  zoomMatrix\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            alpha: pointAlpha, // \n            userAlpha: -1, // \n            texture: texture // \n        },\n\n        blend: {\n            enable: true, // \n            func: {\n                srcRGB: 'one', // RGB\n                srcAlpha: 'one', // Alpha\n                dstRGB: 'one minus src alpha', // RGB\n                dstAlpha: 'one minus src alpha' // Alpha\n            }\n        },\n\n        count: diffGPointCount, // \n        primitive: 'points' // \n    });\n    if (diffGList.length > 0) {\n        drawDiffGPoints();\n    }\n\n\n    // Collect position and color for each point\n    const diffSPositions = [];\n    const diffSPointUvs = [];\n\n    for (const point of diffSList) {\n        diffSPositions.push([point.x, point.y]);\n        diffSPointUvs.push([0.8, 0.8]);\n    }\n\n    // Adjust point width based on the number of points to draw\n    const diffSPointCount = diffSPositions.length;\n\n\n    const drawDiffSPoints = that.searchPointRegl({\n        depth: { enable: false }, // \n        stencil: { enable: false }, // \n        frag: fragmentShader, // \n        vert: vertexShader, // \n\n        attributes: {\n            position: diffSPositions, //  positions\n            textureCoord: diffSPointUvs //  uvs\n        },\n\n        uniforms: {\n            pointWidth: curPointWidth,\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix, //  zoomMatrix\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            alpha: pointAlpha, // \n            userAlpha: -1, // \n            texture: texture // \n        },\n\n        blend: {\n            enable: true, // \n            func: {\n                srcRGB: 'one', // RGB\n                srcAlpha: 'one', // Alpha\n                dstRGB: 'one minus src alpha', // RGB\n                dstAlpha: 'one minus src alpha' // Alpha\n            }\n        },\n\n        count: diffSPointCount, // \n        primitive: 'points' // \n    });\n    if (diffSList.length > 0) {\n        drawDiffSPoints();\n    }\n\n    // Collect position and color for each point\n    const startNodePositions = [];\n    const startNodePointUvs = [];\n\n    for (const point of startNode) {\n        startNodePositions.push([point.x, point.y]);\n        startNodePointUvs.push([0.3, 0.3]);\n    }\n\n    // Adjust point width based on the number of points to draw\n    const startNodePointCount = startNodePositions.length;\n\n\n    const drawstartNodePoints = that.searchPointRegl({\n        depth: { enable: false }, // \n        stencil: { enable: false }, // \n        frag: fragmentShader, // \n        vert: vertexShader, // \n\n        attributes: {\n            position: startNodePositions, //  positions\n            textureCoord: startNodePointUvs //  uvs\n        },\n\n        uniforms: {\n            pointWidth: curPointWidth,\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix, //  zoomMatrix\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            alpha: pointAlpha, // \n            userAlpha: -1, // \n            texture: texture // \n        },\n\n        blend: {\n            enable: true, // \n            func: {\n                srcRGB: 'one', // RGB\n                srcAlpha: 'one', // Alpha\n                dstRGB: 'one minus src alpha', // RGB\n                dstAlpha: 'one minus src alpha' // Alpha\n            }\n        },\n\n        count: startNodePointCount, // \n        primitive: 'points' // \n    });\n    if (startNode.length > 0) {\n        drawstartNodePoints();\n    }\n\n\n}\n\nexport function drawSearchScatterPlot2(that) {\n    if (!that.webGLMatrices) {\n        throw Error('webGLMatrices not initialized');\n    }\n\n    // Clear the WebGL context\n    that.searchPointRegl.clear({\n        color: [0, 0, 0, 0],\n        depth: 1\n    });\n\n    // Adjust point width based on the number of points to draw\n    console.log(\"that.searchPointResults2\", that.searchPointResults2)\n    const pointCount = that.searchPointResults2.length;\n    console.log(\"that.searchPointResults2\", pointCount)\n\n    // Logarithmic regression parameters\n    const a = 6.71682071;\n    const b = -0.437974871;\n    let curPointWidth = a + b * Math.log(config.layout.scatterDotRadius * (that.svgFullSize.height / 760) * pointCount);\n    curPointWidth = Math.min(5, curPointWidth);\n    const alpha = 1 / (Math.log(pointCount) / Math.log(500));\n\n    // Get the current zoom matrix\n    const zoomMatrix = getZoomMatrix(that.curZoomTransform);\n\n    // Create a texture array for point colors\n    const textureArray = [\n        config.layout.timePointColorInt[0],\n        config.layout.timePointColorInt[1],\n        config.layout.timePointColorInt[2],\n        255,\n        config.layout.secondPointColorInt[0],\n        config.layout.secondPointColorInt[1],\n        config.layout.secondPointColorInt[2],\n        255,\n        255,\n        255,\n        255,\n        0\n    ];\n\n    const texture = that.searchPointRegl.texture({\n        width: 3,\n        height: 1,\n        data: textureArray,\n        format: 'rgba'\n    });\n\n    // Collect positions and texture coordinates for each point\n    const positions = [];\n    const uvs = [];\n    console.log(\"that.searchPointResults222222\", that.searchPointResults2)\n\n    for (const point of that.searchPointResults2) {\n        positions.push([point.x, point.y]);\n        uvs.push([0, 0]);\n    }\n\n    const drawPoints = that.searchPointRegl({\n        depth: { enable: false },\n        stencil: { enable: false },\n        frag: fragmentShader,\n        vert: vertexShader,\n        attributes: {\n            position: positions,\n            textureCoord: uvs\n        },\n        uniforms: {\n            pointWidth: curPointWidth,\n            dataScaleMatrix: that.webGLMatrices.dataScaleMatrix,\n            zoomMatrix: zoomMatrix,\n            normalizeMatrix: that.webGLMatrices.normalizeMatrix,\n            alpha: alpha,\n            userAlpha: -1,\n            texture: texture\n        },\n        blend: {\n            enable: true,\n            func: {\n                srcRGB: 'one',\n                srcAlpha: 'one',\n                dstRGB: 'one minus src alpha',\n                dstAlpha: 'one minus src alpha'\n            }\n        },\n        count: pointCount,\n        primitive: 'points'\n    });\n\n    drawPoints();\n\n    console.log(\"that.searchPointResults3333\", that.searchPointResults2)\n}\n\nexport const anyTrue = (items) => items.reduce((a, b) => a || b);\nexport const allTrue = (items) => items.reduce((a, b) => a && b);"],"mappings":"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","ignoreList":[]}]}